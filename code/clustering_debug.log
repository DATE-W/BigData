2024-12-16 17:02:54,697 - INFO - 开始执行聚类分析脚本。
2024-12-16 17:02:54,707 - INFO - 已设置临时目录到 D 盘。
2024-12-16 17:02:54,707 - INFO - 开始读取数据文件。
2024-12-16 17:02:56,777 - INFO - 数据读取完成，共有 1999988 行，14 列。
2024-12-16 17:02:56,779 - INFO - 开始数据预处理。
2024-12-16 17:03:01,643 - INFO - 数据预处理完成。
2024-12-16 17:03:01,643 - INFO - 开始构建特征1：通话呼叫行为。
2024-12-16 17:03:04,226 - INFO - 特征1构建完成。
2024-12-16 17:03:04,226 - INFO - 开始构建特征2：通话时刻。
2024-12-16 19:08:17,972 - INFO - 开始执行聚类分析脚本。
2024-12-16 19:08:17,972 - INFO - 已设置临时目录到 D 盘。
2024-12-16 19:08:17,972 - INFO - 开始读取数据文件。
2024-12-16 19:08:17,974 - INFO - 数据读取完成，共有 10 行，14 列。
2024-12-16 19:08:17,975 - INFO - 开始数据预处理。
2024-12-16 19:08:17,977 - INFO - 数据预处理完成。
2024-12-16 19:08:17,977 - INFO - 开始构建特征1：通话呼叫行为。
2024-12-16 19:08:17,979 - INFO - 特征1构建完成。
2024-12-16 19:08:17,979 - INFO - 开始构建特征2：通话时刻。
2024-12-16 19:08:17,990 - INFO - 特征2构建完成。
2024-12-16 19:08:17,990 - INFO - 开始构建特征3：通话时长。
2024-12-16 19:08:17,994 - INFO - 特征3构建完成。
2024-12-16 19:08:17,994 - INFO - 开始构建特征4：通话类型分布和运营商比例。
2024-12-16 19:08:17,996 - INFO - 通话类型分布特征构建完成。
2024-12-16 19:08:17,998 - INFO - 不同运营商的通话次数特征构建完成。
2024-12-16 19:08:17,998 - INFO - 开始计算运营商比例。
2024-12-16 19:08:17,998 - INFO - 运营商比例计算完成。
2024-12-16 19:08:17,998 - INFO - 所有特征构建完成。
2024-12-16 19:08:17,998 - INFO - 显示部分构建的特征数据。
2024-12-16 19:08:18,010 - INFO - 选择数值型特征进行聚类。
2024-12-16 19:08:18,010 - INFO - 选定的特征包括：['caller_count', 'callee_count', 'Early Morning', 'Morning', 'Afternoon', 'Evening', 'total_dur', 'avg_dur', 'max_dur', 'min_dur', 'call_count', 'call_type_1', 'call_type_2', 'call_type_3', 'optr_1_ratio', 'optr_2_ratio', 'optr_3_ratio']
2024-12-16 19:08:18,010 - INFO - 开始进行特征归一化。
2024-12-16 19:08:18,012 - INFO - 特征归一化完成。
2024-12-16 19:08:18,012 - INFO - 开始使用肘部法则确定最佳聚类数。
2024-12-16 19:08:18,357 - INFO - 肘部法则图已保存为 elbow_method.png。
2024-12-16 19:08:18,434 - INFO - 开始使用轮廓系数确定最佳聚类数。
2024-12-16 19:08:18,609 - INFO - 轮廓系数图已保存为 silhouette_analysis.png。
2024-12-16 19:08:18,687 - INFO - 选择最佳聚类数 k=4。
2024-12-16 19:08:18,687 - INFO - 开始应用K-Means聚类。
2024-12-16 19:08:18,693 - INFO - K-Means聚类完成，聚类标签已添加到特征数据中。
2024-12-16 19:08:18,693 - INFO - 查看聚类中心（逆标准化）。
2024-12-16 19:08:18,702 - INFO - 聚类中心（逆标准化）如下：
2024-12-16 19:08:18,713 - INFO - 
           caller_count  callee_count  ...  optr_2_ratio  optr_3_ratio
Cluster 0           1.0           0.0  ...  3.333333e-01      0.000000
Cluster 1           0.0           1.0  ... -2.775558e-17      0.000000
Cluster 2           1.0           0.0  ...  5.000000e-01      0.000000
Cluster 3           1.0           0.0  ...  3.333333e-01      0.666667

[4 rows x 17 columns]
2024-12-16 19:08:18,713 - INFO - 开始PCA降维以便可视化。
2024-12-16 19:08:18,724 - INFO - PCA降维完成。
2024-12-16 19:08:18,798 - INFO - 聚类结果散点图已保存为 kmeans_pca_scatter.png。
2024-12-16 19:08:18,889 - INFO - 聚类分析脚本执行完成。
2024-12-16 19:08:32,586 - INFO - 开始执行聚类分析脚本。
2024-12-16 19:08:32,587 - INFO - 已设置临时目录到 D 盘。
2024-12-16 19:08:32,587 - INFO - 开始读取数据文件。
2024-12-16 19:08:32,589 - INFO - 数据读取完成，共有 10 行，14 列。
2024-12-16 19:08:32,589 - INFO - 开始数据预处理。
2024-12-16 19:08:32,590 - INFO - 数据预处理完成。
2024-12-16 19:08:32,590 - INFO - 开始构建特征1：通话呼叫行为。
2024-12-16 19:08:32,592 - INFO - 特征1构建完成。
2024-12-16 19:08:32,592 - INFO - 开始构建特征2：通话时刻。
2024-12-16 19:08:32,601 - INFO - 特征2构建完成。
2024-12-16 19:08:32,601 - INFO - 开始构建特征3：通话时长。
2024-12-16 19:08:32,603 - INFO - 特征3构建完成。
2024-12-16 19:08:32,603 - INFO - 开始构建特征4：通话类型分布和运营商比例。
2024-12-16 19:08:32,604 - INFO - 通话类型分布特征构建完成。
2024-12-16 19:08:32,605 - INFO - 不同运营商的通话次数特征构建完成。
2024-12-16 19:08:32,605 - INFO - 开始计算运营商比例。
2024-12-16 19:08:32,606 - INFO - 运营商比例计算完成。
2024-12-16 19:08:32,606 - INFO - 所有特征构建完成。
2024-12-16 19:08:32,606 - INFO - 显示部分构建的特征数据。
2024-12-16 19:08:32,616 - INFO - 选择数值型特征进行聚类。
2024-12-16 19:08:32,617 - INFO - 选定的特征包括：['caller_count', 'callee_count', 'Early Morning', 'Morning', 'Afternoon', 'Evening', 'total_dur', 'avg_dur', 'max_dur', 'min_dur', 'call_count', 'call_type_1', 'call_type_2', 'call_type_3', 'optr_1_ratio', 'optr_2_ratio', 'optr_3_ratio']
2024-12-16 19:08:32,617 - INFO - 开始进行特征归一化。
2024-12-16 19:08:32,618 - INFO - 特征归一化完成。
2024-12-16 19:08:32,618 - INFO - 开始使用肘部法则确定最佳聚类数。
2024-12-16 19:08:32,873 - INFO - 肘部法则图已保存为 elbow_method.png。
2024-12-16 19:08:32,943 - INFO - 开始使用轮廓系数确定最佳聚类数。
2024-12-16 19:08:33,093 - INFO - 轮廓系数图已保存为 silhouette_analysis.png。
2024-12-16 19:08:33,167 - INFO - 选择最佳聚类数 k=4。
2024-12-16 19:08:33,167 - INFO - 开始应用K-Means聚类。
2024-12-16 19:08:33,174 - INFO - K-Means聚类完成，聚类标签已添加到特征数据中。
2024-12-16 19:08:33,174 - INFO - 查看聚类中心（逆标准化）。
2024-12-16 19:08:33,184 - INFO - 聚类中心（逆标准化）如下：
2024-12-16 19:08:33,193 - INFO - 
           caller_count  callee_count  ...  optr_2_ratio  optr_3_ratio
Cluster 0           1.0           0.0  ...  3.333333e-01      0.000000
Cluster 1           0.0           1.0  ... -2.775558e-17      0.000000
Cluster 2           1.0           0.0  ...  5.000000e-01      0.000000
Cluster 3           1.0           0.0  ...  3.333333e-01      0.666667

[4 rows x 17 columns]
2024-12-16 19:08:33,193 - INFO - 开始PCA降维以便可视化。
2024-12-16 19:08:33,195 - INFO - PCA降维完成。
2024-12-16 19:08:33,281 - INFO - 聚类结果散点图已保存为 kmeans_pca_scatter.png。
2024-12-16 19:08:33,345 - INFO - 聚类分析脚本执行完成。
2024-12-16 19:16:07,407 - INFO - 开始执行聚类分析脚本。
2024-12-16 19:16:07,407 - INFO - 已设置临时目录到 D 盘。
2024-12-16 19:16:07,407 - INFO - 开始读取数据文件。
2024-12-16 19:16:07,409 - INFO - 数据读取完成，共有 10 行，14 列。
2024-12-16 19:16:07,409 - INFO - 开始数据预处理。
2024-12-16 19:16:07,411 - INFO - 数据预处理完成。
2024-12-16 19:16:07,411 - INFO - 开始构建特征1：通话呼叫行为。
2024-12-16 19:16:07,412 - INFO - 特征1构建完成。
2024-12-16 19:16:07,412 - INFO - 开始构建特征2：通话时刻。
2024-12-16 19:16:07,421 - INFO - 特征2构建完成。
2024-12-16 19:16:07,421 - INFO - 开始构建特征3：通话时长。
2024-12-16 19:16:07,423 - INFO - 特征3构建完成。
2024-12-16 19:16:07,423 - INFO - 开始构建特征4：通话类型分布和运营商比例。
2024-12-16 19:16:07,426 - INFO - 通话类型分布特征构建完成。
2024-12-16 19:16:07,426 - INFO - 不同运营商的通话次数特征构建完成。
2024-12-16 19:16:07,426 - INFO - 开始计算运营商比例。
2024-12-16 19:16:07,427 - INFO - 运营商比例计算完成。
2024-12-16 19:16:07,427 - INFO - 所有特征构建完成。
2024-12-16 19:16:07,427 - INFO - 显示部分构建的特征数据。
2024-12-16 19:16:07,436 - INFO - 选择数值型特征进行聚类。
2024-12-16 19:16:07,436 - INFO - 选定的特征包括：['caller_count', 'callee_count', 'Early Morning', 'Morning', 'Afternoon', 'Evening', 'total_dur', 'avg_dur', 'max_dur', 'min_dur', 'call_count', 'call_type_1', 'call_type_2', 'call_type_3', 'optr_1_ratio', 'optr_2_ratio', 'optr_3_ratio']
2024-12-16 19:16:07,436 - INFO - 开始进行特征归一化。
2024-12-16 19:16:07,437 - INFO - 特征归一化完成。
2024-12-16 19:16:07,438 - INFO - 开始使用肘部法则确定最佳聚类数。
2024-12-16 19:16:07,732 - INFO - 肘部法则图已保存为 elbow_method.png。
2024-12-16 19:16:07,806 - INFO - 开始使用轮廓系数确定最佳聚类数。
2024-12-16 19:16:07,972 - INFO - 轮廓系数图已保存为 silhouette_analysis.png。
2024-12-16 19:16:08,038 - INFO - 选择最佳聚类数 k=4。
2024-12-16 19:16:08,039 - INFO - 开始应用K-Means聚类。
2024-12-16 19:16:08,045 - INFO - K-Means聚类完成，聚类标签已添加到特征数据中。
2024-12-16 19:16:08,045 - INFO - 查看聚类中心（逆标准化）。
2024-12-16 19:16:08,054 - INFO - 聚类中心（逆标准化）如下：
2024-12-16 19:16:08,062 - INFO - 
           caller_count  callee_count  ...  optr_2_ratio  optr_3_ratio
Cluster 0           1.0           0.0  ...  3.333333e-01      0.000000
Cluster 1           0.0           1.0  ... -2.775558e-17      0.000000
Cluster 2           1.0           0.0  ...  5.000000e-01      0.000000
Cluster 3           1.0           0.0  ...  3.333333e-01      0.666667

[4 rows x 17 columns]
2024-12-16 19:16:08,063 - INFO - 开始PCA降维以便可视化。
2024-12-16 19:16:08,064 - INFO - PCA降维完成。
2024-12-16 19:16:08,144 - INFO - 聚类结果散点图已保存为 kmeans_pca_scatter.png。
2024-12-16 19:16:08,206 - INFO - 聚类分析脚本执行完成。
2024-12-16 19:16:27,951 - INFO - 开始执行聚类分析脚本。
2024-12-16 19:16:27,951 - INFO - 已设置临时目录到 D 盘。
2024-12-16 19:16:27,951 - INFO - 开始读取数据文件。
2024-12-16 19:16:27,953 - INFO - 数据读取完成，共有 10 行，14 列。
2024-12-16 19:16:27,953 - INFO - 开始数据预处理。
2024-12-16 19:16:27,955 - INFO - 数据预处理完成。
2024-12-16 19:16:27,955 - INFO - 开始构建特征1：通话呼叫行为。
2024-12-16 19:16:27,957 - INFO - 特征1构建完成。
2024-12-16 19:16:27,957 - INFO - 开始构建特征2：通话时刻。
2024-12-16 19:16:27,966 - INFO - 特征2构建完成。
2024-12-16 19:16:27,966 - INFO - 开始构建特征3：通话时长。
2024-12-16 19:16:27,968 - INFO - 特征3构建完成。
2024-12-16 19:16:27,968 - INFO - 开始构建特征4：通话类型分布和运营商比例。
2024-12-16 19:16:27,969 - INFO - 通话类型分布特征构建完成。
2024-12-16 19:16:27,971 - INFO - 不同运营商的通话次数特征构建完成。
2024-12-16 19:16:27,971 - INFO - 开始计算运营商比例。
2024-12-16 19:16:27,971 - INFO - 运营商比例计算完成。
2024-12-16 19:16:27,971 - INFO - 所有特征构建完成。
2024-12-16 19:16:27,971 - INFO - 显示部分构建的特征数据。
2024-12-16 19:16:27,981 - INFO - 选择数值型特征进行聚类。
2024-12-16 19:16:27,982 - INFO - 选定的特征包括：['caller_count', 'callee_count', 'Early Morning', 'Morning', 'Afternoon', 'Evening', 'total_dur', 'avg_dur', 'max_dur', 'min_dur', 'call_count', 'call_type_1', 'call_type_2', 'call_type_3', 'optr_1_ratio', 'optr_2_ratio', 'optr_3_ratio']
2024-12-16 19:16:27,982 - INFO - 开始进行特征归一化。
2024-12-16 19:16:27,983 - INFO - 特征归一化完成。
2024-12-16 19:16:27,983 - INFO - 开始使用肘部法则确定最佳聚类数。
2024-12-16 19:16:28,254 - INFO - 肘部法则图已保存为 elbow_method.png。
2024-12-16 19:16:28,322 - INFO - 开始使用轮廓系数确定最佳聚类数。
2024-12-16 19:16:28,480 - INFO - 轮廓系数图已保存为 silhouette_analysis.png。
2024-12-16 19:16:28,554 - INFO - 选择最佳聚类数 k=4。
2024-12-16 19:16:28,554 - INFO - 开始应用K-Means聚类。
2024-12-16 19:16:28,562 - INFO - K-Means聚类完成，聚类标签已添加到特征数据中。
2024-12-16 19:16:28,563 - INFO - 查看聚类中心（逆标准化）。
2024-12-16 19:16:28,574 - INFO - 聚类中心（逆标准化）如下：
2024-12-16 19:16:28,582 - INFO - 
           caller_count  callee_count  ...  optr_2_ratio  optr_3_ratio
Cluster 0           1.0           0.0  ...  3.333333e-01      0.000000
Cluster 1           0.0           1.0  ... -2.775558e-17      0.000000
Cluster 2           1.0           0.0  ...  5.000000e-01      0.000000
Cluster 3           1.0           0.0  ...  3.333333e-01      0.666667

[4 rows x 17 columns]
2024-12-16 19:16:28,582 - INFO - 开始PCA降维以便可视化。
2024-12-16 19:16:28,584 - INFO - PCA降维完成。
2024-12-16 19:16:28,670 - INFO - 聚类结果散点图已保存为 kmeans_pca_scatter.png。
2024-12-16 19:16:28,741 - INFO - 聚类分析脚本执行完成。
2024-12-16 19:18:42,220 - INFO - 开始执行聚类分析脚本。
2024-12-16 19:18:42,221 - INFO - 已设置临时目录到 D 盘。
2024-12-16 19:18:42,221 - INFO - 开始读取数据文件。
2024-12-16 19:18:42,223 - INFO - 数据读取完成，共有 10 行，14 列。
2024-12-16 19:18:42,223 - INFO - 开始数据预处理。
2024-12-16 19:18:42,225 - INFO - 数据预处理完成。
2024-12-16 19:18:42,225 - INFO - 开始构建特征1：通话呼叫行为。
2024-12-16 19:18:42,226 - INFO - 特征1构建完成。
2024-12-16 19:18:42,226 - INFO - 开始构建特征2：通话时刻。
2024-12-16 19:18:42,240 - INFO - 特征2构建完成。
2024-12-16 19:18:42,240 - INFO - 开始构建特征3：通话时长。
2024-12-16 19:18:42,242 - INFO - 特征3构建完成。
2024-12-16 19:18:42,242 - INFO - 开始构建特征4：通话类型分布和运营商比例。
2024-12-16 19:18:42,244 - INFO - 通话类型分布特征构建完成。
2024-12-16 19:18:42,245 - INFO - 不同运营商的通话次数特征构建完成。
2024-12-16 19:18:42,245 - INFO - 开始计算运营商比例。
2024-12-16 19:18:42,245 - INFO - 运营商比例计算完成。
2024-12-16 19:18:42,246 - INFO - 所有特征构建完成。
2024-12-16 19:18:42,246 - INFO - 显示部分构建的特征数据。
2024-12-16 19:18:42,255 - INFO - 选择数值型特征进行聚类。
2024-12-16 19:18:42,255 - INFO - 选定的特征包括：['caller_count', 'callee_count', 'Early Morning', 'Morning', 'Afternoon', 'Evening', 'total_dur', 'avg_dur', 'max_dur', 'min_dur', 'call_count', 'call_type_1', 'call_type_2', 'call_type_3', 'optr_1_ratio', 'optr_2_ratio', 'optr_3_ratio']
2024-12-16 19:18:42,255 - INFO - 特征数据形状: (20, 17)
2024-12-16 19:18:42,256 - INFO - 重置特征数据框的索引。
2024-12-16 19:18:42,256 - INFO - 开始进行特征归一化。
2024-12-16 19:18:42,257 - INFO - 特征归一化完成。
2024-12-16 19:18:42,257 - INFO - 开始使用肘部法则确定最佳聚类数。
2024-12-16 19:18:42,535 - INFO - 肘部法则图已保存为 elbow_method.png。
2024-12-16 19:18:42,612 - INFO - 开始使用轮廓系数确定最佳聚类数。
2024-12-16 19:18:42,778 - INFO - 轮廓系数图已保存为 silhouette_analysis.png。
2024-12-16 19:18:42,867 - INFO - 选择最佳聚类数 k=4。
2024-12-16 19:18:42,868 - INFO - 开始应用K-Means聚类。
2024-12-16 19:18:42,873 - INFO - K-Means聚类完成。
2024-12-16 19:18:42,873 - INFO - K-Means标签数量: 20, 特征数据框行数: 20
2024-12-16 19:18:42,874 - INFO - 聚类标签已成功添加到特征数据框中。
2024-12-16 19:18:42,874 - INFO - 显示部分聚类标签数据。
2024-12-16 19:18:42,874 - INFO - 查看聚类中心（逆标准化）。
2024-12-16 19:18:42,884 - INFO - 聚类中心（逆标准化）如下：
2024-12-16 19:18:42,892 - INFO - 
           caller_count  callee_count  ...  optr_2_ratio  optr_3_ratio
Cluster 0           1.0           0.0  ...  3.333333e-01      0.000000
Cluster 1           0.0           1.0  ... -2.775558e-17      0.000000
Cluster 2           1.0           0.0  ...  5.000000e-01      0.000000
Cluster 3           1.0           0.0  ...  3.333333e-01      0.666667

[4 rows x 17 columns]
2024-12-16 19:18:42,893 - INFO - 开始PCA降维以便可视化。
2024-12-16 19:18:42,894 - INFO - PCA降维完成。
2024-12-16 19:18:42,894 - INFO - PCA DataFrame形状: (20, 3)
2024-12-16 19:18:42,894 - INFO - PCA DataFrame中 'cluster' 列唯一值: [2 3 0 1]
2024-12-16 19:18:42,895 - INFO - 将 'cluster' 列转换为字符串类型。
2024-12-16 19:18:43,005 - INFO - 聚类结果散点图已保存为 kmeans_pca_scatter.png。
2024-12-16 19:18:43,073 - INFO - 聚类分析脚本执行完成。
2024-12-16 19:19:15,508 - INFO - 开始执行聚类分析脚本。
2024-12-16 19:19:15,508 - INFO - 已设置临时目录到 D 盘。
2024-12-16 19:19:15,508 - INFO - 开始读取数据文件。
2024-12-16 19:19:17,596 - INFO - 数据读取完成，共有 1999988 行，14 列。
2024-12-16 19:19:17,596 - INFO - 开始数据预处理。
2024-12-16 19:19:22,824 - INFO - 数据预处理完成。
2024-12-16 19:19:22,824 - INFO - 开始构建特征1：通话呼叫行为。
2024-12-16 19:19:25,683 - INFO - 特征1构建完成。
2024-12-16 19:19:25,683 - INFO - 开始构建特征2：通话时刻。
2024-12-16 19:24:23,962 - INFO - 开始执行聚类分析脚本。
2024-12-16 19:24:23,962 - INFO - 已设置临时目录到 D 盘。
2024-12-16 19:24:23,962 - INFO - 开始读取数据文件。
2024-12-16 19:24:23,964 - INFO - 数据读取完成，共有 10 行，14 列。
2024-12-16 19:24:23,964 - INFO - 开始数据预处理。
2024-12-16 19:24:23,965 - INFO - 数据预处理完成。
2024-12-16 19:24:23,965 - INFO - 开始构建特征1：通话呼叫行为。
2024-12-16 19:24:23,967 - INFO - 特征1构建完成。
2024-12-16 19:24:23,967 - INFO - 开始构建特征2：通话时刻（使用进度条）。
2024-12-16 19:24:23,979 - INFO - 特征2构建完成。
2024-12-16 19:24:23,979 - INFO - 开始构建特征3：通话时长。
2024-12-16 19:24:23,981 - INFO - 特征3构建完成。
2024-12-16 19:24:23,981 - INFO - 开始构建特征4：通话类型分布和运营商比例。
2024-12-16 19:24:23,982 - INFO - 通话类型分布特征构建完成。
2024-12-16 19:24:23,984 - INFO - 不同运营商的通话次数特征构建完成。
2024-12-16 19:24:23,984 - INFO - 开始计算运营商比例。
2024-12-16 19:24:23,984 - INFO - 运营商比例计算完成。
2024-12-16 19:24:23,984 - INFO - 所有特征构建完成。
2024-12-16 19:24:23,984 - INFO - 显示部分构建的特征数据。
2024-12-16 19:24:23,994 - INFO - 选择数值型特征进行聚类。
2024-12-16 19:24:23,995 - INFO - 选定的特征包括：['caller_count', 'callee_count', 'Early Morning', 'Morning', 'Afternoon', 'Evening', 'total_dur', 'avg_dur', 'max_dur', 'min_dur', 'call_count', 'call_type_1', 'call_type_2', 'call_type_3', 'optr_1_ratio', 'optr_2_ratio', 'optr_3_ratio']
2024-12-16 19:24:23,995 - INFO - 特征数据形状: (20, 17)
2024-12-16 19:24:23,995 - INFO - 重置特征数据框的索引。
2024-12-16 19:24:23,995 - INFO - 开始进行特征归一化。
2024-12-16 19:24:23,996 - INFO - 特征归一化完成。
2024-12-16 19:24:23,996 - INFO - 开始使用肘部法则确定最佳聚类数。
2024-12-16 19:24:24,255 - INFO - 肘部法则图已保存为 elbow_method.png。
2024-12-16 19:24:24,323 - INFO - 开始使用轮廓系数确定最佳聚类数。
2024-12-16 19:24:24,502 - INFO - 轮廓系数图已保存为 silhouette_analysis.png。
2024-12-16 19:24:24,578 - INFO - 选择最佳聚类数 k=4。
2024-12-16 19:24:24,579 - INFO - 开始应用K-Means聚类。
2024-12-16 19:24:24,585 - INFO - K-Means聚类完成。
2024-12-16 19:24:24,585 - INFO - K-Means标签数量: 20, 特征数据框行数: 20
2024-12-16 19:24:24,585 - INFO - 聚类标签已成功添加到特征数据框中。
2024-12-16 19:24:24,586 - INFO - 显示部分聚类标签数据。
2024-12-16 19:24:24,586 - INFO - 查看聚类中心（逆标准化）。
2024-12-16 19:24:24,596 - INFO - 聚类中心（逆标准化）如下：
2024-12-16 19:24:24,605 - INFO - 
           caller_count  callee_count  ...  optr_2_ratio  optr_3_ratio
Cluster 0           1.0           0.0  ...  3.333333e-01      0.000000
Cluster 1           0.0           1.0  ... -2.775558e-17      0.000000
Cluster 2           1.0           0.0  ...  5.000000e-01      0.000000
Cluster 3           1.0           0.0  ...  3.333333e-01      0.666667

[4 rows x 17 columns]
2024-12-16 19:24:24,605 - INFO - 开始PCA降维以便可视化。
2024-12-16 19:24:24,606 - INFO - PCA降维完成。
2024-12-16 19:24:24,606 - INFO - PCA DataFrame形状: (20, 3)
2024-12-16 19:24:24,606 - INFO - PCA DataFrame中 'cluster' 列唯一值: [2 3 0 1]
2024-12-16 19:24:24,606 - INFO - PCA DataFrame中 'cluster' 列存在NaN: 0
2024-12-16 19:24:24,606 - INFO - 将 'cluster' 列转换为字符串类型。
2024-12-16 19:24:24,699 - INFO - 聚类结果散点图已保存为 kmeans_pca_scatter.png。
2024-12-16 19:24:24,766 - INFO - 聚类分析脚本执行完成。
2024-12-16 19:24:51,655 - INFO - 开始执行聚类分析脚本。
2024-12-16 19:24:51,655 - INFO - 已设置临时目录到 D 盘。
2024-12-16 19:24:51,655 - INFO - 开始读取数据文件。
2024-12-16 19:24:55,947 - INFO - 开始执行聚类分析脚本。
2024-12-16 19:24:55,947 - INFO - 已设置临时目录到 D 盘。
2024-12-16 19:24:55,947 - INFO - 开始读取数据文件。
2024-12-16 19:24:58,033 - INFO - 数据读取完成，共有 1999988 行，14 列。
2024-12-16 19:24:58,034 - INFO - 开始数据预处理。
2024-12-16 19:25:02,971 - INFO - 数据预处理完成。
2024-12-16 19:25:02,971 - INFO - 开始构建特征1：通话呼叫行为。
2024-12-16 19:25:05,631 - INFO - 特征1构建完成。
2024-12-16 19:25:05,631 - INFO - 开始构建特征2：通话时刻（使用进度条）。
2024-12-16 19:47:47,226 - INFO - 特征2构建完成。
2024-12-16 19:47:47,226 - INFO - 开始构建特征3：通话时长。
2024-12-16 19:47:47,946 - INFO - 特征3构建完成。
2024-12-16 19:47:47,946 - INFO - 开始构建特征4：通话类型分布和运营商比例。
2024-12-16 19:47:48,672 - INFO - 通话类型分布特征构建完成。
2024-12-16 19:47:49,444 - INFO - 不同运营商的通话次数特征构建完成。
2024-12-16 19:47:49,445 - INFO - 开始计算运营商比例。
2024-12-16 19:47:49,464 - INFO - 运营商比例计算完成。
2024-12-16 19:47:49,554 - INFO - 所有特征构建完成。
2024-12-16 19:47:49,554 - INFO - 显示部分构建的特征数据。
2024-12-16 19:47:49,564 - INFO - 选择数值型特征进行聚类。
2024-12-16 19:47:49,609 - INFO - 选定的特征包括：['caller_count', 'callee_count', 'Early Morning', 'Morning', 'Afternoon', 'Evening', 'total_dur', 'avg_dur', 'max_dur', 'min_dur', 'call_count', 'call_type_1', 'call_type_2', 'call_type_3', 'optr_1_ratio', 'optr_2_ratio', 'optr_3_ratio']
2024-12-16 19:47:49,609 - INFO - 特征数据形状: (1685260, 17)
2024-12-16 19:47:49,816 - INFO - 重置特征数据框的索引。
2024-12-16 19:47:49,816 - INFO - 开始进行特征归一化。
2024-12-16 19:47:50,182 - INFO - 特征归一化完成。
2024-12-16 19:47:50,182 - INFO - 开始使用肘部法则确定最佳聚类数。
2024-12-16 19:47:59,170 - INFO - 肘部法则图已保存为 elbow_method.png。
2024-12-16 19:47:59,248 - INFO - 开始使用轮廓系数确定最佳聚类数。
2024-12-16 20:19:13,865 - INFO - 开始执行聚类分析脚本。
2024-12-16 20:19:13,865 - INFO - 已设置临时目录到 D 盘。
2024-12-16 20:19:13,865 - INFO - 开始读取数据文件。
2024-12-16 20:19:14,468 - ERROR - 在执行聚类分析脚本时发生错误。
Traceback (most recent call last):
  File "D:\sthgithub\BigData\code\feature.py", line 47, in <module>
    df = pd.read_csv(dataFile, sep='\t', header=None, names=column_names)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\homework\dixueds\code\venv\Lib\site-packages\pandas\io\parsers\readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\homework\dixueds\code\venv\Lib\site-packages\pandas\io\parsers\readers.py", line 626, in _read
    return parser.read(nrows)
           ^^^^^^^^^^^^^^^^^^
  File "D:\homework\dixueds\code\venv\Lib\site-packages\pandas\io\parsers\readers.py", line 1923, in read
    ) = self._engine.read(  # type: ignore[attr-defined]
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\homework\dixueds\code\venv\Lib\site-packages\pandas\io\parsers\c_parser_wrapper.py", line 234, in read
    chunks = self._reader.read_low_memory(nrows)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "parsers.pyx", line 838, in pandas._libs.parsers.TextReader.read_low_memory
  File "parsers.pyx", line 905, in pandas._libs.parsers.TextReader._read_rows
  File "parsers.pyx", line 874, in pandas._libs.parsers.TextReader._tokenize_rows
  File "parsers.pyx", line 891, in pandas._libs.parsers.TextReader._check_tokenize_status
  File "parsers.pyx", line 2061, in pandas._libs.parsers.raise_parser_error
pandas.errors.ParserError: Error tokenizing data. C error: Calling read(nbytes) on source failed. Try engine='python'.
2024-12-16 20:20:17,575 - INFO - 开始执行聚类分析脚本。
2024-12-16 20:20:17,575 - INFO - 已设置临时目录到 D 盘。
2024-12-16 20:20:17,575 - INFO - 开始读取数据文件。
2024-12-16 20:20:17,578 - INFO - 数据读取完成，共有 10 行，14 列。
2024-12-16 20:20:17,578 - INFO - 开始数据预处理。
2024-12-16 20:20:17,579 - INFO - 数据预处理完成。
2024-12-16 20:20:17,579 - INFO - 开始构建特征1：通话呼叫行为。
2024-12-16 20:20:17,581 - INFO - 特征1构建完成。
2024-12-16 20:20:17,581 - INFO - 开始构建特征2：通话时刻（向量化处理）。
2024-12-16 20:20:17,586 - INFO - 特征2构建完成。
2024-12-16 20:20:17,587 - INFO - 开始构建特征3：通话时长。
2024-12-16 20:20:17,588 - INFO - 特征3构建完成。
2024-12-16 20:20:17,588 - INFO - 开始构建特征4：通话类型分布和运营商比例。
2024-12-16 20:20:17,589 - INFO - 通话类型分布特征构建完成。
2024-12-16 20:20:17,590 - INFO - 不同运营商的通话次数特征构建完成。
2024-12-16 20:20:17,590 - INFO - 开始计算运营商比例。
2024-12-16 20:20:17,591 - INFO - 运营商比例计算完成。
2024-12-16 20:20:17,591 - INFO - 所有特征构建完成。
2024-12-16 20:20:17,591 - INFO - 显示部分构建的特征数据。
2024-12-16 20:20:17,601 - INFO - 选择数值型特征进行聚类。
2024-12-16 20:20:17,601 - INFO - 选定的特征包括：['caller_count', 'callee_count', 'Early Morning', 'Morning', 'Afternoon', 'Evening', 'total_dur', 'avg_dur', 'max_dur', 'min_dur', 'call_count', 'call_type_1', 'call_type_2', 'call_type_3', 'optr_1_ratio', 'optr_2_ratio', 'optr_3_ratio']
2024-12-16 20:20:17,601 - INFO - 特征数据形状: (20, 17)
2024-12-16 20:20:17,601 - INFO - 重置特征数据框的索引。
2024-12-16 20:20:17,602 - INFO - 开始进行特征归一化。
2024-12-16 20:20:17,603 - INFO - 特征归一化完成。
2024-12-16 20:20:17,603 - INFO - 开始使用肘部法则确定最佳聚类数。
2024-12-16 20:20:17,883 - INFO - 肘部法则图已保存为 elbow_method.png。
2024-12-16 20:20:17,954 - INFO - 开始使用轮廓系数确定最佳聚类数。
2024-12-16 20:20:18,122 - INFO - 轮廓系数图已保存为 silhouette_analysis.png。
2024-12-16 20:20:18,200 - INFO - 选择最佳聚类数 k=4。
2024-12-16 20:20:18,200 - INFO - 开始应用K-Means聚类。
2024-12-16 20:20:18,206 - INFO - K-Means聚类完成。
2024-12-16 20:20:18,206 - INFO - K-Means标签数量: 20, 特征数据框行数: 20
2024-12-16 20:20:18,206 - INFO - 聚类标签已成功添加到特征数据框中。
2024-12-16 20:20:18,207 - INFO - 显示部分聚类标签数据。
2024-12-16 20:20:18,207 - INFO - 查看聚类中心（逆标准化）。
2024-12-16 20:20:18,217 - INFO - 聚类中心（逆标准化）如下：
2024-12-16 20:20:18,230 - INFO - 
           caller_count  callee_count  ...  optr_2_ratio  optr_3_ratio
Cluster 0           1.0           0.0  ...  3.333333e-01      0.000000
Cluster 1           0.0           1.0  ... -2.775558e-17      0.000000
Cluster 2           1.0           0.0  ...  5.000000e-01      0.000000
Cluster 3           1.0           0.0  ...  3.333333e-01      0.666667

[4 rows x 17 columns]
2024-12-16 20:20:18,230 - INFO - 开始PCA降维以便可视化。
2024-12-16 20:20:18,254 - INFO - PCA降维完成。
2024-12-16 20:20:18,254 - INFO - PCA DataFrame形状: (20, 3)
2024-12-16 20:20:18,256 - INFO - PCA DataFrame中 'cluster' 列唯一值: [2 3 0 1]
2024-12-16 20:20:18,262 - INFO - PCA DataFrame中 'cluster' 列存在NaN: 0
2024-12-16 20:20:18,263 - INFO - 将 'cluster' 列转换为字符串类型。
2024-12-16 20:20:18,366 - INFO - 聚类结果散点图已保存为 kmeans_pca_scatter.png。
2024-12-16 20:20:18,432 - INFO - 聚类分析脚本执行完成。
2024-12-16 20:20:37,122 - INFO - 开始执行聚类分析脚本。
2024-12-16 20:20:37,122 - INFO - 已设置临时目录到 D 盘。
2024-12-16 20:20:37,122 - INFO - 开始读取数据文件。
2024-12-16 20:20:39,084 - INFO - 数据读取完成，共有 1999988 行，14 列。
2024-12-16 20:20:39,084 - INFO - 开始数据预处理。
2024-12-16 20:20:43,824 - INFO - 数据预处理完成。
2024-12-16 20:20:43,824 - INFO - 开始构建特征1：通话呼叫行为。
2024-12-16 20:20:46,345 - INFO - 特征1构建完成。
2024-12-16 20:20:46,345 - INFO - 开始构建特征2：通话时刻（向量化处理）。
2024-12-16 20:20:47,667 - INFO - 特征2构建完成。
2024-12-16 20:20:47,667 - INFO - 开始构建特征3：通话时长。
2024-12-16 20:20:48,341 - INFO - 特征3构建完成。
2024-12-16 20:20:48,341 - INFO - 开始构建特征4：通话类型分布和运营商比例。
2024-12-16 20:20:48,990 - INFO - 通话类型分布特征构建完成。
2024-12-16 20:20:49,680 - INFO - 不同运营商的通话次数特征构建完成。
2024-12-16 20:20:49,680 - INFO - 开始计算运营商比例。
2024-12-16 20:20:49,698 - INFO - 运营商比例计算完成。
2024-12-16 20:20:49,774 - INFO - 所有特征构建完成。
2024-12-16 20:20:49,774 - INFO - 显示部分构建的特征数据。
2024-12-16 20:20:49,784 - INFO - 选择数值型特征进行聚类。
2024-12-16 20:20:49,827 - INFO - 选定的特征包括：['caller_count', 'callee_count', 'Early Morning', 'Morning', 'Afternoon', 'Evening', 'total_dur', 'avg_dur', 'max_dur', 'min_dur', 'call_count', 'call_type_1', 'call_type_2', 'call_type_3', 'optr_1_ratio', 'optr_2_ratio', 'optr_3_ratio']
2024-12-16 20:20:49,827 - INFO - 特征数据形状: (1685260, 17)
2024-12-16 20:20:49,989 - INFO - 重置特征数据框的索引。
2024-12-16 20:20:49,989 - INFO - 开始进行特征归一化。
2024-12-16 20:20:50,332 - INFO - 特征归一化完成。
2024-12-16 20:20:50,332 - INFO - 开始使用肘部法则确定最佳聚类数。
2024-12-16 20:20:59,118 - INFO - 肘部法则图已保存为 elbow_method.png。
2024-12-16 20:20:59,200 - INFO - 开始使用轮廓系数确定最佳聚类数。
2024-12-16 20:30:30,630 - INFO - 开始执行聚类分析脚本。
2024-12-16 20:30:30,630 - INFO - 已设置临时目录到 D 盘。
2024-12-16 20:30:30,630 - INFO - 开始读取数据文件。
2024-12-16 20:30:30,631 - INFO - 数据读取完成，共有 10 行，14 列。
2024-12-16 20:30:30,632 - INFO - 开始数据预处理。
2024-12-16 20:30:30,633 - INFO - 数据预处理完成。
2024-12-16 20:30:30,633 - INFO - 检查数据中的异常值。
2024-12-16 20:30:30,637 - INFO - 删除了 raw_dur 大于 874.35 的异常值，原始数据形状 (10, 14)，处理后形状 (9, 14)。
2024-12-16 20:30:30,637 - INFO - 开始构建特征1：通话呼叫行为。
2024-12-16 20:30:30,638 - INFO - 特征1构建完成。
2024-12-16 20:30:30,638 - INFO - 开始构建特征2：通话时刻（向量化处理）。
2024-12-16 20:30:30,641 - INFO - 特征2构建完成。
2024-12-16 20:30:30,641 - INFO - 开始构建特征3：通话时长。
2024-12-16 20:30:30,643 - INFO - 特征3构建完成。
2024-12-16 20:30:30,643 - INFO - 开始构建特征4：通话类型分布和运营商比例。
2024-12-16 20:30:30,644 - INFO - 通话类型分布特征构建完成。
2024-12-16 20:30:30,645 - INFO - 不同运营商的通话次数特征构建完成。
2024-12-16 20:30:30,645 - INFO - 开始计算运营商比例。
2024-12-16 20:30:30,646 - INFO - 运营商比例计算完成。
2024-12-16 20:30:30,646 - INFO - 所有特征构建完成。
2024-12-16 20:30:30,646 - INFO - 显示部分构建的特征数据。
2024-12-16 20:30:30,655 - INFO - 选择数值型特征进行聚类。
2024-12-16 20:30:30,656 - INFO - 选定的特征包括：['caller_count', 'callee_count', 'Early Morning', 'Morning', 'Afternoon', 'Evening', 'total_dur', 'avg_dur', 'max_dur', 'min_dur', 'call_count', 'call_type_1', 'call_type_2', 'call_type_3', 'optr_1_ratio', 'optr_2_ratio', 'optr_3_ratio']
2024-12-16 20:30:30,656 - INFO - 特征数据形状: (18, 17)
2024-12-16 20:30:30,656 - INFO - 重置特征数据框的索引。
2024-12-16 20:30:30,656 - INFO - 开始进行特征归一化。
2024-12-16 20:30:30,657 - INFO - 特征归一化完成。
2024-12-16 20:30:30,657 - INFO - 开始使用肘部法则确定最佳聚类数。
2024-12-16 20:30:30,658 - INFO - 正在计算 k=1 的K-Means聚类。
2024-12-16 20:30:30,857 - INFO - k=1 的SSE: 306.00000000000006
2024-12-16 20:30:30,857 - INFO - 正在计算 k=2 的K-Means聚类。
2024-12-16 20:30:30,901 - INFO - k=2 的SSE: 164.37321160482753
2024-12-16 20:30:30,902 - INFO - 正在计算 k=3 的K-Means聚类。
2024-12-16 20:30:30,930 - INFO - k=3 的SSE: 111.23087382284699
2024-12-16 20:30:30,930 - INFO - 正在计算 k=4 的K-Means聚类。
2024-12-16 20:30:30,966 - INFO - k=4 的SSE: 79.19151401860049
2024-12-16 20:30:30,966 - INFO - 正在计算 k=5 的K-Means聚类。
2024-12-16 20:30:31,003 - INFO - k=5 的SSE: 56.40594888767571
2024-12-16 20:30:31,003 - INFO - 正在计算 k=6 的K-Means聚类。
2024-12-16 20:30:31,040 - INFO - k=6 的SSE: 40.62610208816705
2024-12-16 20:30:31,040 - INFO - 正在计算 k=7 的K-Means聚类。
2024-12-16 20:30:31,073 - INFO - k=7 的SSE: 25.418515909844217
2024-12-16 20:30:31,075 - INFO - 正在计算 k=8 的K-Means聚类。
2024-12-16 20:30:31,109 - INFO - k=8 的SSE: 11.725658766987074
2024-12-16 20:30:31,109 - INFO - 正在计算 k=9 的K-Means聚类。
2024-12-16 20:30:31,149 - INFO - k=9 的SSE: 0.0011600928074245913
2024-12-16 20:30:31,149 - INFO - 正在计算 k=10 的K-Means聚类。
2024-12-16 20:30:31,186 - INFO - k=10 的SSE: 2.2186712959340957e-30
2024-12-16 20:30:31,291 - INFO - 肘部法则图已保存为 elbow_method.png。
2024-12-16 20:30:31,368 - INFO - 开始使用轮廓系数确定最佳聚类数。
2024-12-16 20:30:31,368 - INFO - 正在计算 k=2 的轮廓系数。
2024-12-16 20:30:31,398 - INFO - k=2 的轮廓系数: 0.5517408295714957
2024-12-16 20:30:31,398 - INFO - 正在计算 k=3 的轮廓系数。
2024-12-16 20:30:31,430 - INFO - k=3 的轮廓系数: 0.5927138728508474
2024-12-16 20:30:31,431 - INFO - 正在计算 k=4 的轮廓系数。
2024-12-16 20:30:31,462 - INFO - k=4 的轮廓系数: 0.6137711297939239
2024-12-16 20:30:31,462 - INFO - 正在计算 k=5 的轮廓系数。
2024-12-16 20:30:31,496 - INFO - k=5 的轮廓系数: 0.6576766006580732
2024-12-16 20:30:31,496 - INFO - 正在计算 k=6 的轮廓系数。
2024-12-16 20:30:31,532 - INFO - k=6 的轮廓系数: 0.6426590645784659
2024-12-16 20:30:31,533 - INFO - 正在计算 k=7 的轮廓系数。
2024-12-16 20:30:31,570 - INFO - k=7 的轮廓系数: 0.6240510285190511
2024-12-16 20:30:31,570 - INFO - 正在计算 k=8 的轮廓系数。
2024-12-16 20:30:31,605 - INFO - k=8 的轮廓系数: 0.6197665016330188
2024-12-16 20:30:31,605 - INFO - 正在计算 k=9 的轮廓系数。
2024-12-16 20:30:31,638 - INFO - k=9 的轮廓系数: 0.6101159831030315
2024-12-16 20:30:31,638 - INFO - 正在计算 k=10 的轮廓系数。
2024-12-16 20:30:31,673 - INFO - k=10 的轮廓系数: 0.5
2024-12-16 20:30:31,761 - INFO - 轮廓系数图已保存为 silhouette_analysis.png。
2024-12-16 20:30:31,836 - INFO - 基于轮廓系数选择的最佳聚类数 k=5，轮廓系数为 0.6576766006580732
2024-12-16 20:30:31,836 - INFO - 最终选择的最佳聚类数 k=5。
2024-12-16 20:30:31,836 - INFO - 开始应用K-Means聚类。
2024-12-16 20:30:31,890 - INFO - K-Means聚类完成。
2024-12-16 20:30:31,890 - INFO - K-Means标签数量: 18, 特征数据框行数: 18
2024-12-16 20:30:31,890 - INFO - 聚类标签已成功添加到特征数据框中。
2024-12-16 20:30:31,891 - INFO - 显示部分聚类标签数据。
2024-12-16 20:30:31,891 - INFO - 查看聚类中心（逆标准化）。
2024-12-16 20:30:31,900 - INFO - 聚类中心（逆标准化）如下：
2024-12-16 20:30:31,911 - INFO - 
           caller_count  callee_count  ...  optr_2_ratio  optr_3_ratio
Cluster 0           1.0           0.0  ...  3.333333e-01  6.666667e-01
Cluster 1           0.0           1.0  ...  5.551115e-17  2.775558e-17
Cluster 2           1.0           0.0  ...  2.775558e-17 -1.387779e-17
Cluster 3           1.0           0.0  ...  1.000000e+00 -1.387779e-17
Cluster 4           1.0           0.0  ...  5.000000e-01 -1.387779e-17

[5 rows x 17 columns]
2024-12-16 20:30:31,911 - INFO - 开始PCA降维以便可视化。
2024-12-16 20:30:31,912 - INFO - PCA降维完成。
2024-12-16 20:30:31,912 - INFO - PCA DataFrame形状: (18, 3)
2024-12-16 20:30:31,912 - INFO - PCA DataFrame中 'cluster' 列唯一值: [3 2 0 4 1]
2024-12-16 20:30:31,913 - INFO - PCA DataFrame中 'cluster' 列存在NaN: 0
2024-12-16 20:30:31,913 - INFO - 将 'cluster' 列转换为字符串类型。
2024-12-16 20:30:32,008 - INFO - 聚类结果散点图已保存为 kmeans_pca_scatter.png。
2024-12-16 20:30:32,077 - INFO - 聚类分析脚本执行完成。
2024-12-16 20:30:52,552 - INFO - 开始执行聚类分析脚本。
2024-12-16 20:30:52,553 - INFO - 已设置临时目录到 D 盘。
2024-12-16 20:30:52,553 - INFO - 开始读取数据文件。
2024-12-16 20:30:54,549 - INFO - 数据读取完成，共有 1999988 行，14 列。
2024-12-16 20:30:54,549 - INFO - 开始数据预处理。
2024-12-16 20:30:59,424 - INFO - 数据预处理完成。
2024-12-16 20:30:59,591 - INFO - 检查数据中的异常值。
2024-12-16 20:30:59,748 - INFO - 删除了 raw_dur 大于 1065.0 的异常值，原始数据形状 (1999988, 14)，处理后形状 (1980010, 14)。
2024-12-16 20:30:59,748 - INFO - 开始构建特征1：通话呼叫行为。
2024-12-16 20:31:02,327 - INFO - 特征1构建完成。
2024-12-16 20:31:02,327 - INFO - 开始构建特征2：通话时刻（向量化处理）。
2024-12-16 20:31:03,686 - INFO - 特征2构建完成。
2024-12-16 20:31:03,686 - INFO - 开始构建特征3：通话时长。
2024-12-16 20:31:04,351 - INFO - 特征3构建完成。
2024-12-16 20:31:04,351 - INFO - 开始构建特征4：通话类型分布和运营商比例。
2024-12-16 20:31:04,998 - INFO - 通话类型分布特征构建完成。
2024-12-16 20:31:05,676 - INFO - 不同运营商的通话次数特征构建完成。
2024-12-16 20:31:05,676 - INFO - 开始计算运营商比例。
2024-12-16 20:31:05,695 - INFO - 运营商比例计算完成。
2024-12-16 20:31:05,771 - INFO - 所有特征构建完成。
2024-12-16 20:31:05,771 - INFO - 显示部分构建的特征数据。
2024-12-16 20:31:05,781 - INFO - 选择数值型特征进行聚类。
2024-12-16 20:31:05,823 - INFO - 选定的特征包括：['caller_count', 'callee_count', 'Early Morning', 'Morning', 'Afternoon', 'Evening', 'total_dur', 'avg_dur', 'max_dur', 'min_dur', 'call_count', 'call_type_1', 'call_type_2', 'call_type_3', 'optr_1_ratio', 'optr_2_ratio', 'optr_3_ratio']
2024-12-16 20:31:05,823 - INFO - 特征数据形状: (1672456, 17)
2024-12-16 20:31:05,977 - INFO - 重置特征数据框的索引。
2024-12-16 20:31:05,977 - INFO - 开始进行特征归一化。
2024-12-16 20:31:06,310 - INFO - 特征归一化完成。
2024-12-16 20:31:06,310 - INFO - 开始使用肘部法则确定最佳聚类数。
2024-12-16 20:31:06,310 - INFO - 正在计算 k=1 的K-Means聚类。
2024-12-16 20:31:07,325 - INFO - k=1 的SSE: 28431751.999989603
2024-12-16 20:31:07,325 - INFO - 正在计算 k=2 的K-Means聚类。
2024-12-16 20:31:10,733 - INFO - k=2 的SSE: 20108576.749355786
2024-12-16 20:31:10,733 - INFO - 正在计算 k=3 的K-Means聚类。
2024-12-16 20:31:17,664 - INFO - k=3 的SSE: 17073660.994811174
2024-12-16 20:31:17,665 - INFO - 正在计算 k=4 的K-Means聚类。
2024-12-16 20:31:27,810 - INFO - k=4 的SSE: 15519003.432333149
2024-12-16 20:31:27,810 - INFO - 正在计算 k=5 的K-Means聚类。
2024-12-16 20:31:39,083 - INFO - k=5 的SSE: 14210632.831650361
2024-12-16 20:31:39,083 - INFO - 正在计算 k=6 的K-Means聚类。
2024-12-16 20:31:54,154 - INFO - k=6 的SSE: 12913267.747142024
2024-12-16 20:31:54,154 - INFO - 正在计算 k=7 的K-Means聚类。
2024-12-16 20:32:08,910 - INFO - k=7 的SSE: 11822378.465195091
2024-12-16 20:32:08,911 - INFO - 正在计算 k=8 的K-Means聚类。
2024-12-16 20:32:25,465 - INFO - k=8 的SSE: 10845481.674466362
2024-12-16 20:32:25,466 - INFO - 正在计算 k=9 的K-Means聚类。
2024-12-16 20:32:50,392 - INFO - k=9 的SSE: 9929835.292918576
2024-12-16 20:32:50,392 - INFO - 正在计算 k=10 的K-Means聚类。
2024-12-16 20:33:17,936 - INFO - k=10 的SSE: 9206726.5957913
2024-12-16 20:33:18,020 - INFO - 肘部法则图已保存为 elbow_method.png。
2024-12-16 20:33:18,100 - INFO - 开始使用轮廓系数确定最佳聚类数。
2024-12-16 20:33:18,100 - INFO - 正在计算 k=2 的轮廓系数。
2024-12-16 20:37:44,001 - INFO - 开始执行聚类分析脚本。
2024-12-16 20:37:44,001 - INFO - 已设置临时目录到 D 盘。
2024-12-16 20:37:44,001 - INFO - 开始读取数据文件。
2024-12-16 20:37:44,002 - INFO - 数据读取完成，共有 10 行，14 列。
2024-12-16 20:37:44,003 - INFO - 开始数据预处理。
2024-12-16 20:37:44,004 - INFO - 数据预处理完成。
2024-12-16 20:37:44,004 - INFO - 检查数据中的异常值。
2024-12-16 20:37:44,005 - INFO - 删除了 raw_dur 大于 874.35 的异常值，原始数据形状 (10, 14)，处理后形状 (9, 14)。
2024-12-16 20:37:44,005 - INFO - 开始构建特征1：通话呼叫行为。
2024-12-16 20:37:44,006 - INFO - 特征1构建完成。
2024-12-16 20:37:44,006 - INFO - 开始构建特征2：通话时刻（向量化处理）。
2024-12-16 20:37:44,009 - INFO - 特征2构建完成。
2024-12-16 20:37:44,009 - INFO - 开始构建特征3：通话时长。
2024-12-16 20:37:44,010 - INFO - 特征3构建完成。
2024-12-16 20:37:44,010 - INFO - 开始构建特征4：通话类型分布和运营商比例。
2024-12-16 20:37:44,012 - INFO - 通话类型分布特征构建完成。
2024-12-16 20:37:44,013 - INFO - 不同运营商的通话次数特征构建完成。
2024-12-16 20:37:44,013 - INFO - 开始计算运营商比例。
2024-12-16 20:37:44,014 - INFO - 运营商比例计算完成。
2024-12-16 20:37:44,014 - INFO - 所有特征构建完成。
2024-12-16 20:37:44,014 - INFO - 显示部分构建的特征数据。
2024-12-16 20:37:44,024 - INFO - 选择数值型特征进行聚类。
2024-12-16 20:37:44,025 - INFO - 选定的特征包括：['caller_count', 'callee_count', 'Early Morning', 'Morning', 'Afternoon', 'Evening', 'total_dur', 'avg_dur', 'max_dur', 'min_dur', 'call_count', 'call_type_1', 'call_type_2', 'call_type_3', 'optr_1_ratio', 'optr_2_ratio', 'optr_3_ratio']
2024-12-16 20:37:44,025 - INFO - 特征数据形状: (18, 17)
2024-12-16 20:37:44,025 - INFO - 重置特征数据框的索引。
2024-12-16 20:37:44,025 - INFO - 开始进行特征归一化。
2024-12-16 20:37:44,027 - INFO - 特征归一化完成。
2024-12-16 20:37:44,027 - INFO - 开始使用肘部法则确定最佳聚类数。
2024-12-16 20:37:44,028 - INFO - 正在计算 k=1 的K-Means聚类。
2024-12-16 20:37:44,028 - ERROR - 在执行聚类分析脚本时发生错误。
Traceback (most recent call last):
  File "D:\sthgithub\BigData\code\feature.py", line 179, in <module>
    kmeans.fit(X_scaled)
  File "D:\homework\dixueds\code\venv\Lib\site-packages\sklearn\base.py", line 1466, in wrapper
    estimator._validate_params()
  File "D:\homework\dixueds\code\venv\Lib\site-packages\sklearn\base.py", line 666, in _validate_params
    validate_parameter_constraints(
  File "D:\homework\dixueds\code\venv\Lib\site-packages\sklearn\utils\_param_validation.py", line 95, in validate_parameter_constraints
    raise InvalidParameterError(
sklearn.utils._param_validation.InvalidParameterError: The 'algorithm' parameter of KMeans must be a str among {'elkan', 'lloyd'}. Got 'auto' instead.
2024-12-16 20:38:43,019 - INFO - 开始执行聚类分析脚本。
2024-12-16 20:38:43,019 - INFO - 已设置临时目录到 D 盘。
2024-12-16 20:38:43,019 - INFO - 开始读取数据文件。
2024-12-16 20:38:43,021 - INFO - 数据读取完成，共有 10 行，14 列。
2024-12-16 20:38:43,021 - INFO - 开始数据预处理。
2024-12-16 20:38:43,023 - INFO - 数据预处理完成。
2024-12-16 20:38:43,023 - INFO - 检查数据中的异常值。
2024-12-16 20:38:43,024 - INFO - 删除了 raw_dur 大于 874.35 的异常值，原始数据形状 (10, 14)，处理后形状 (9, 14)。
2024-12-16 20:38:43,024 - INFO - 开始构建特征1：通话呼叫行为。
2024-12-16 20:38:43,026 - INFO - 特征1构建完成。
2024-12-16 20:38:43,026 - INFO - 开始构建特征2：通话时刻（向量化处理）。
2024-12-16 20:38:43,029 - INFO - 特征2构建完成。
2024-12-16 20:38:43,029 - INFO - 开始构建特征3：通话时长。
2024-12-16 20:38:43,030 - INFO - 特征3构建完成。
2024-12-16 20:38:43,030 - INFO - 开始构建特征4：通话类型分布和运营商比例。
2024-12-16 20:38:43,033 - INFO - 通话类型分布特征构建完成。
2024-12-16 20:38:43,034 - INFO - 不同运营商的通话次数特征构建完成。
2024-12-16 20:38:43,034 - INFO - 开始计算运营商比例。
2024-12-16 20:38:43,034 - INFO - 运营商比例计算完成。
2024-12-16 20:38:43,035 - INFO - 所有特征构建完成。
2024-12-16 20:38:43,035 - INFO - 显示部分构建的特征数据。
2024-12-16 20:38:43,043 - INFO - 选择数值型特征进行聚类。
2024-12-16 20:38:43,044 - INFO - 选定的特征包括：['caller_count', 'callee_count', 'Early Morning', 'Morning', 'Afternoon', 'Evening', 'total_dur', 'avg_dur', 'max_dur', 'min_dur', 'call_count', 'call_type_1', 'call_type_2', 'call_type_3', 'optr_1_ratio', 'optr_2_ratio', 'optr_3_ratio']
2024-12-16 20:38:43,044 - INFO - 特征数据形状: (18, 17)
2024-12-16 20:38:43,044 - INFO - 重置特征数据框的索引。
2024-12-16 20:38:43,044 - INFO - 开始进行特征归一化。
2024-12-16 20:38:43,045 - INFO - 特征归一化完成。
2024-12-16 20:38:43,045 - INFO - 开始使用肘部法则确定最佳聚类数。
2024-12-16 20:38:43,046 - INFO - 正在计算 k=1 的K-Means聚类。
2024-12-16 20:38:43,193 - INFO - k=1 的SSE: 306.00000000000006
2024-12-16 20:38:43,193 - INFO - 正在计算 k=2 的K-Means聚类。
2024-12-16 20:38:43,225 - INFO - k=2 的SSE: 164.37321160482753
2024-12-16 20:38:43,225 - INFO - 正在计算 k=3 的K-Means聚类。
2024-12-16 20:38:43,256 - INFO - k=3 的SSE: 111.23087382284699
2024-12-16 20:38:43,256 - INFO - 正在计算 k=4 的K-Means聚类。
2024-12-16 20:38:43,293 - INFO - k=4 的SSE: 79.19151401860049
2024-12-16 20:38:43,293 - INFO - 正在计算 k=5 的K-Means聚类。
2024-12-16 20:38:43,330 - INFO - k=5 的SSE: 56.40594888767571
2024-12-16 20:38:43,330 - INFO - 正在计算 k=6 的K-Means聚类。
2024-12-16 20:38:43,363 - INFO - k=6 的SSE: 40.62610208816705
2024-12-16 20:38:43,363 - INFO - 正在计算 k=7 的K-Means聚类。
2024-12-16 20:38:43,397 - INFO - k=7 的SSE: 25.418515909844217
2024-12-16 20:38:43,397 - INFO - 正在计算 k=8 的K-Means聚类。
2024-12-16 20:38:43,432 - INFO - k=8 的SSE: 11.725658766987074
2024-12-16 20:38:43,432 - INFO - 正在计算 k=9 的K-Means聚类。
2024-12-16 20:38:43,475 - INFO - k=9 的SSE: 0.0011600928074245913
2024-12-16 20:38:43,475 - INFO - 正在计算 k=10 的K-Means聚类。
2024-12-16 20:38:43,512 - INFO - k=10 的SSE: 2.2186712959340957e-30
2024-12-16 20:38:43,614 - INFO - 肘部法则图已保存为 elbow_method.png。
2024-12-16 20:38:43,681 - INFO - 开始使用轮廓系数确定最佳聚类数。
2024-12-16 20:38:43,682 - INFO - 正在计算 k=2 的轮廓系数。
2024-12-16 20:38:43,682 - ERROR - k=2 的轮廓系数计算失败: The 'algorithm' parameter of KMeans must be a str among {'elkan', 'lloyd'}. Got 'auto' instead.
2024-12-16 20:38:43,682 - INFO - 正在计算 k=3 的轮廓系数。
2024-12-16 20:38:43,682 - ERROR - k=3 的轮廓系数计算失败: The 'algorithm' parameter of KMeans must be a str among {'elkan', 'lloyd'}. Got 'auto' instead.
2024-12-16 20:38:43,682 - INFO - 正在计算 k=4 的轮廓系数。
2024-12-16 20:38:43,682 - ERROR - k=4 的轮廓系数计算失败: The 'algorithm' parameter of KMeans must be a str among {'elkan', 'lloyd'}. Got 'auto' instead.
2024-12-16 20:38:43,682 - INFO - 正在计算 k=5 的轮廓系数。
2024-12-16 20:38:43,682 - ERROR - k=5 的轮廓系数计算失败: The 'algorithm' parameter of KMeans must be a str among {'elkan', 'lloyd'}. Got 'auto' instead.
2024-12-16 20:38:43,682 - INFO - 正在计算 k=6 的轮廓系数。
2024-12-16 20:38:43,683 - ERROR - k=6 的轮廓系数计算失败: The 'algorithm' parameter of KMeans must be a str among {'elkan', 'lloyd'}. Got 'auto' instead.
2024-12-16 20:38:43,683 - INFO - 正在计算 k=7 的轮廓系数。
2024-12-16 20:38:43,683 - ERROR - k=7 的轮廓系数计算失败: The 'algorithm' parameter of KMeans must be a str among {'elkan', 'lloyd'}. Got 'auto' instead.
2024-12-16 20:38:43,683 - INFO - 正在计算 k=8 的轮廓系数。
2024-12-16 20:38:43,683 - ERROR - k=8 的轮廓系数计算失败: The 'algorithm' parameter of KMeans must be a str among {'elkan', 'lloyd'}. Got 'auto' instead.
2024-12-16 20:38:43,683 - INFO - 正在计算 k=9 的轮廓系数。
2024-12-16 20:38:43,683 - ERROR - k=9 的轮廓系数计算失败: The 'algorithm' parameter of KMeans must be a str among {'elkan', 'lloyd'}. Got 'auto' instead.
2024-12-16 20:38:43,683 - INFO - 正在计算 k=10 的轮廓系数。
2024-12-16 20:38:43,683 - ERROR - k=10 的轮廓系数计算失败: The 'algorithm' parameter of KMeans must be a str among {'elkan', 'lloyd'}. Got 'auto' instead.
2024-12-16 20:38:43,735 - INFO - 轮廓系数图已保存为 silhouette_analysis.png。
2024-12-16 20:38:43,819 - WARNING - 没有有效的轮廓系数，无法基于轮廓系数选择最佳k。
2024-12-16 20:38:43,819 - INFO - 最终选择的最佳聚类数 k=4。
2024-12-16 20:38:43,819 - INFO - 开始应用K-Means聚类。
2024-12-16 20:38:43,819 - ERROR - 在执行聚类分析脚本时发生错误。
Traceback (most recent call last):
  File "D:\sthgithub\BigData\code\feature.py", line 249, in <module>
    kmeans.fit(X_scaled)
  File "D:\homework\dixueds\code\venv\Lib\site-packages\sklearn\base.py", line 1466, in wrapper
    estimator._validate_params()
  File "D:\homework\dixueds\code\venv\Lib\site-packages\sklearn\base.py", line 666, in _validate_params
    validate_parameter_constraints(
  File "D:\homework\dixueds\code\venv\Lib\site-packages\sklearn\utils\_param_validation.py", line 95, in validate_parameter_constraints
    raise InvalidParameterError(
sklearn.utils._param_validation.InvalidParameterError: The 'algorithm' parameter of KMeans must be a str among {'elkan', 'lloyd'}. Got 'auto' instead.
2024-12-16 20:39:02,239 - INFO - 开始执行聚类分析脚本。
2024-12-16 20:39:02,239 - INFO - 已设置临时目录到 D 盘。
2024-12-16 20:39:02,239 - INFO - 开始读取数据文件。
2024-12-16 20:39:02,241 - INFO - 数据读取完成，共有 10 行，14 列。
2024-12-16 20:39:02,241 - INFO - 开始数据预处理。
2024-12-16 20:39:02,243 - INFO - 数据预处理完成。
2024-12-16 20:39:02,243 - INFO - 检查数据中的异常值。
2024-12-16 20:39:02,244 - INFO - 删除了 raw_dur 大于 874.35 的异常值，原始数据形状 (10, 14)，处理后形状 (9, 14)。
2024-12-16 20:39:02,244 - INFO - 开始构建特征1：通话呼叫行为。
2024-12-16 20:39:02,247 - INFO - 特征1构建完成。
2024-12-16 20:39:02,247 - INFO - 开始构建特征2：通话时刻（向量化处理）。
2024-12-16 20:39:02,248 - INFO - 特征2构建完成。
2024-12-16 20:39:02,248 - INFO - 开始构建特征3：通话时长。
2024-12-16 20:39:02,251 - INFO - 特征3构建完成。
2024-12-16 20:39:02,251 - INFO - 开始构建特征4：通话类型分布和运营商比例。
2024-12-16 20:39:02,252 - INFO - 通话类型分布特征构建完成。
2024-12-16 20:39:02,253 - INFO - 不同运营商的通话次数特征构建完成。
2024-12-16 20:39:02,253 - INFO - 开始计算运营商比例。
2024-12-16 20:39:02,253 - INFO - 运营商比例计算完成。
2024-12-16 20:39:02,253 - INFO - 所有特征构建完成。
2024-12-16 20:39:02,253 - INFO - 显示部分构建的特征数据。
2024-12-16 20:39:02,263 - INFO - 选择数值型特征进行聚类。
2024-12-16 20:39:02,264 - INFO - 选定的特征包括：['caller_count', 'callee_count', 'Early Morning', 'Morning', 'Afternoon', 'Evening', 'total_dur', 'avg_dur', 'max_dur', 'min_dur', 'call_count', 'call_type_1', 'call_type_2', 'call_type_3', 'optr_1_ratio', 'optr_2_ratio', 'optr_3_ratio']
2024-12-16 20:39:02,264 - INFO - 特征数据形状: (18, 17)
2024-12-16 20:39:02,264 - INFO - 重置特征数据框的索引。
2024-12-16 20:39:02,264 - INFO - 开始进行特征归一化。
2024-12-16 20:39:02,265 - INFO - 特征归一化完成。
2024-12-16 20:39:02,265 - INFO - 开始使用肘部法则确定最佳聚类数。
2024-12-16 20:39:02,266 - INFO - 正在计算 k=1 的K-Means聚类。
2024-12-16 20:39:02,444 - INFO - k=1 的SSE: 306.00000000000006
2024-12-16 20:39:02,444 - INFO - 正在计算 k=2 的K-Means聚类。
2024-12-16 20:39:02,512 - INFO - k=2 的SSE: 164.37321160482753
2024-12-16 20:39:02,512 - INFO - 正在计算 k=3 的K-Means聚类。
2024-12-16 20:39:02,567 - INFO - k=3 的SSE: 111.23087382284699
2024-12-16 20:39:02,567 - INFO - 正在计算 k=4 的K-Means聚类。
2024-12-16 20:39:02,620 - INFO - k=4 的SSE: 79.19151401860049
2024-12-16 20:39:02,620 - INFO - 正在计算 k=5 的K-Means聚类。
2024-12-16 20:39:02,676 - INFO - k=5 的SSE: 56.40594888767571
2024-12-16 20:39:02,677 - INFO - 正在计算 k=6 的K-Means聚类。
2024-12-16 20:39:02,734 - INFO - k=6 的SSE: 40.62610208816705
2024-12-16 20:39:02,734 - INFO - 正在计算 k=7 的K-Means聚类。
2024-12-16 20:39:02,791 - INFO - k=7 的SSE: 25.418515909844217
2024-12-16 20:39:02,791 - INFO - 正在计算 k=8 的K-Means聚类。
2024-12-16 20:39:02,849 - INFO - k=8 的SSE: 11.725658766987074
2024-12-16 20:39:02,849 - INFO - 正在计算 k=9 的K-Means聚类。
2024-12-16 20:39:02,910 - INFO - k=9 的SSE: 0.0011600928074245913
2024-12-16 20:39:02,910 - INFO - 正在计算 k=10 的K-Means聚类。
2024-12-16 20:39:02,969 - INFO - k=10 的SSE: 2.2186712959340957e-30
2024-12-16 20:39:03,065 - INFO - 肘部法则图已保存为 elbow_method.png。
2024-12-16 20:39:03,139 - INFO - 开始使用轮廓系数确定最佳聚类数。
2024-12-16 20:39:03,139 - INFO - 正在计算 k=2 的轮廓系数。
2024-12-16 20:39:03,139 - ERROR - k=2 的轮廓系数计算失败: The 'algorithm' parameter of KMeans must be a str among {'lloyd', 'elkan'}. Got 'auto' instead.
2024-12-16 20:39:03,139 - INFO - 正在计算 k=3 的轮廓系数。
2024-12-16 20:39:03,139 - ERROR - k=3 的轮廓系数计算失败: The 'algorithm' parameter of KMeans must be a str among {'lloyd', 'elkan'}. Got 'auto' instead.
2024-12-16 20:39:03,139 - INFO - 正在计算 k=4 的轮廓系数。
2024-12-16 20:39:03,139 - ERROR - k=4 的轮廓系数计算失败: The 'algorithm' parameter of KMeans must be a str among {'lloyd', 'elkan'}. Got 'auto' instead.
2024-12-16 20:39:03,139 - INFO - 正在计算 k=5 的轮廓系数。
2024-12-16 20:39:03,139 - ERROR - k=5 的轮廓系数计算失败: The 'algorithm' parameter of KMeans must be a str among {'lloyd', 'elkan'}. Got 'auto' instead.
2024-12-16 20:39:03,139 - INFO - 正在计算 k=6 的轮廓系数。
2024-12-16 20:39:03,140 - ERROR - k=6 的轮廓系数计算失败: The 'algorithm' parameter of KMeans must be a str among {'lloyd', 'elkan'}. Got 'auto' instead.
2024-12-16 20:39:03,140 - INFO - 正在计算 k=7 的轮廓系数。
2024-12-16 20:39:03,140 - ERROR - k=7 的轮廓系数计算失败: The 'algorithm' parameter of KMeans must be a str among {'lloyd', 'elkan'}. Got 'auto' instead.
2024-12-16 20:39:03,140 - INFO - 正在计算 k=8 的轮廓系数。
2024-12-16 20:39:03,140 - ERROR - k=8 的轮廓系数计算失败: The 'algorithm' parameter of KMeans must be a str among {'lloyd', 'elkan'}. Got 'auto' instead.
2024-12-16 20:39:03,140 - INFO - 正在计算 k=9 的轮廓系数。
2024-12-16 20:39:03,140 - ERROR - k=9 的轮廓系数计算失败: The 'algorithm' parameter of KMeans must be a str among {'lloyd', 'elkan'}. Got 'auto' instead.
2024-12-16 20:39:03,140 - INFO - 正在计算 k=10 的轮廓系数。
2024-12-16 20:39:03,140 - ERROR - k=10 的轮廓系数计算失败: The 'algorithm' parameter of KMeans must be a str among {'lloyd', 'elkan'}. Got 'auto' instead.
2024-12-16 20:39:03,190 - INFO - 轮廓系数图已保存为 silhouette_analysis.png。
2024-12-16 20:39:03,266 - WARNING - 没有有效的轮廓系数，无法基于轮廓系数选择最佳k。
2024-12-16 20:39:03,266 - INFO - 最终选择的最佳聚类数 k=4。
2024-12-16 20:39:03,266 - INFO - 开始应用K-Means聚类。
2024-12-16 20:39:03,266 - ERROR - 在执行聚类分析脚本时发生错误。
Traceback (most recent call last):
  File "D:\sthgithub\BigData\code\feature.py", line 249, in <module>
    kmeans.fit(X_scaled)
  File "D:\homework\dixueds\code\venv\Lib\site-packages\sklearn\base.py", line 1466, in wrapper
    estimator._validate_params()
  File "D:\homework\dixueds\code\venv\Lib\site-packages\sklearn\base.py", line 666, in _validate_params
    validate_parameter_constraints(
  File "D:\homework\dixueds\code\venv\Lib\site-packages\sklearn\utils\_param_validation.py", line 95, in validate_parameter_constraints
    raise InvalidParameterError(
sklearn.utils._param_validation.InvalidParameterError: The 'algorithm' parameter of KMeans must be a str among {'lloyd', 'elkan'}. Got 'auto' instead.
2024-12-16 20:39:20,785 - INFO - 开始执行聚类分析脚本。
2024-12-16 20:39:20,785 - INFO - 已设置临时目录到 D 盘。
2024-12-16 20:39:20,786 - INFO - 开始读取数据文件。
2024-12-16 20:39:20,787 - INFO - 数据读取完成，共有 10 行，14 列。
2024-12-16 20:39:20,787 - INFO - 开始数据预处理。
2024-12-16 20:39:20,789 - INFO - 数据预处理完成。
2024-12-16 20:39:20,789 - INFO - 检查数据中的异常值。
2024-12-16 20:39:20,790 - INFO - 删除了 raw_dur 大于 874.35 的异常值，原始数据形状 (10, 14)，处理后形状 (9, 14)。
2024-12-16 20:39:20,790 - INFO - 开始构建特征1：通话呼叫行为。
2024-12-16 20:39:20,791 - INFO - 特征1构建完成。
2024-12-16 20:39:20,791 - INFO - 开始构建特征2：通话时刻（向量化处理）。
2024-12-16 20:39:20,794 - INFO - 特征2构建完成。
2024-12-16 20:39:20,794 - INFO - 开始构建特征3：通话时长。
2024-12-16 20:39:20,795 - INFO - 特征3构建完成。
2024-12-16 20:39:20,795 - INFO - 开始构建特征4：通话类型分布和运营商比例。
2024-12-16 20:39:20,796 - INFO - 通话类型分布特征构建完成。
2024-12-16 20:39:20,797 - INFO - 不同运营商的通话次数特征构建完成。
2024-12-16 20:39:20,798 - INFO - 开始计算运营商比例。
2024-12-16 20:39:20,798 - INFO - 运营商比例计算完成。
2024-12-16 20:39:20,799 - INFO - 所有特征构建完成。
2024-12-16 20:39:20,799 - INFO - 显示部分构建的特征数据。
2024-12-16 20:39:20,809 - INFO - 选择数值型特征进行聚类。
2024-12-16 20:39:20,809 - INFO - 选定的特征包括：['caller_count', 'callee_count', 'Early Morning', 'Morning', 'Afternoon', 'Evening', 'total_dur', 'avg_dur', 'max_dur', 'min_dur', 'call_count', 'call_type_1', 'call_type_2', 'call_type_3', 'optr_1_ratio', 'optr_2_ratio', 'optr_3_ratio']
2024-12-16 20:39:20,809 - INFO - 特征数据形状: (18, 17)
2024-12-16 20:39:20,809 - INFO - 重置特征数据框的索引。
2024-12-16 20:39:20,809 - INFO - 开始进行特征归一化。
2024-12-16 20:39:20,811 - INFO - 特征归一化完成。
2024-12-16 20:39:20,811 - INFO - 开始使用肘部法则确定最佳聚类数。
2024-12-16 20:39:20,812 - INFO - 正在计算 k=1 的K-Means聚类。
2024-12-16 20:39:20,969 - INFO - k=1 的SSE: 306.00000000000006
2024-12-16 20:39:20,969 - INFO - 正在计算 k=2 的K-Means聚类。
2024-12-16 20:39:21,039 - INFO - k=2 的SSE: 164.37321160482753
2024-12-16 20:39:21,039 - INFO - 正在计算 k=3 的K-Means聚类。
2024-12-16 20:39:21,102 - INFO - k=3 的SSE: 111.23087382284699
2024-12-16 20:39:21,103 - INFO - 正在计算 k=4 的K-Means聚类。
2024-12-16 20:39:21,157 - INFO - k=4 的SSE: 79.19151401860049
2024-12-16 20:39:21,157 - INFO - 正在计算 k=5 的K-Means聚类。
2024-12-16 20:39:21,207 - INFO - k=5 的SSE: 56.40594888767571
2024-12-16 20:39:21,207 - INFO - 正在计算 k=6 的K-Means聚类。
2024-12-16 20:39:21,258 - INFO - k=6 的SSE: 40.62610208816705
2024-12-16 20:39:21,258 - INFO - 正在计算 k=7 的K-Means聚类。
2024-12-16 20:39:21,315 - INFO - k=7 的SSE: 25.418515909844217
2024-12-16 20:39:21,316 - INFO - 正在计算 k=8 的K-Means聚类。
2024-12-16 20:39:21,369 - INFO - k=8 的SSE: 11.725658766987074
2024-12-16 20:39:21,369 - INFO - 正在计算 k=9 的K-Means聚类。
2024-12-16 20:39:21,421 - INFO - k=9 的SSE: 0.0011600928074245913
2024-12-16 20:39:21,422 - INFO - 正在计算 k=10 的K-Means聚类。
2024-12-16 20:39:21,473 - INFO - k=10 的SSE: 2.2186712959340957e-30
2024-12-16 20:39:21,578 - INFO - 肘部法则图已保存为 elbow_method.png。
2024-12-16 20:39:21,647 - INFO - 开始使用轮廓系数确定最佳聚类数。
2024-12-16 20:39:21,647 - INFO - 正在计算 k=2 的轮廓系数。
2024-12-16 20:39:21,647 - ERROR - k=2 的轮廓系数计算失败: The 'algorithm' parameter of KMeans must be a str among {'lloyd', 'elkan'}. Got 'auto' instead.
2024-12-16 20:39:21,647 - INFO - 正在计算 k=3 的轮廓系数。
2024-12-16 20:39:21,647 - ERROR - k=3 的轮廓系数计算失败: The 'algorithm' parameter of KMeans must be a str among {'lloyd', 'elkan'}. Got 'auto' instead.
2024-12-16 20:39:21,648 - INFO - 正在计算 k=4 的轮廓系数。
2024-12-16 20:39:21,648 - ERROR - k=4 的轮廓系数计算失败: The 'algorithm' parameter of KMeans must be a str among {'lloyd', 'elkan'}. Got 'auto' instead.
2024-12-16 20:39:21,648 - INFO - 正在计算 k=5 的轮廓系数。
2024-12-16 20:39:21,648 - ERROR - k=5 的轮廓系数计算失败: The 'algorithm' parameter of KMeans must be a str among {'lloyd', 'elkan'}. Got 'auto' instead.
2024-12-16 20:39:21,648 - INFO - 正在计算 k=6 的轮廓系数。
2024-12-16 20:39:21,648 - ERROR - k=6 的轮廓系数计算失败: The 'algorithm' parameter of KMeans must be a str among {'lloyd', 'elkan'}. Got 'auto' instead.
2024-12-16 20:39:21,648 - INFO - 正在计算 k=7 的轮廓系数。
2024-12-16 20:39:21,648 - ERROR - k=7 的轮廓系数计算失败: The 'algorithm' parameter of KMeans must be a str among {'lloyd', 'elkan'}. Got 'auto' instead.
2024-12-16 20:39:21,648 - INFO - 正在计算 k=8 的轮廓系数。
2024-12-16 20:39:21,648 - ERROR - k=8 的轮廓系数计算失败: The 'algorithm' parameter of KMeans must be a str among {'lloyd', 'elkan'}. Got 'auto' instead.
2024-12-16 20:39:21,648 - INFO - 正在计算 k=9 的轮廓系数。
2024-12-16 20:39:21,648 - ERROR - k=9 的轮廓系数计算失败: The 'algorithm' parameter of KMeans must be a str among {'lloyd', 'elkan'}. Got 'auto' instead.
2024-12-16 20:39:21,648 - INFO - 正在计算 k=10 的轮廓系数。
2024-12-16 20:39:21,648 - ERROR - k=10 的轮廓系数计算失败: The 'algorithm' parameter of KMeans must be a str among {'lloyd', 'elkan'}. Got 'auto' instead.
2024-12-16 20:39:21,697 - INFO - 轮廓系数图已保存为 silhouette_analysis.png。
2024-12-16 20:39:21,780 - WARNING - 没有有效的轮廓系数，无法基于轮廓系数选择最佳k。
2024-12-16 20:39:21,780 - INFO - 最终选择的最佳聚类数 k=4。
2024-12-16 20:39:21,780 - INFO - 开始应用K-Means聚类。
2024-12-16 20:39:21,844 - INFO - K-Means聚类完成。
2024-12-16 20:39:21,844 - INFO - K-Means标签数量: 18, 特征数据框行数: 18
2024-12-16 20:39:21,844 - INFO - 聚类标签已成功添加到特征数据框中。
2024-12-16 20:39:21,844 - INFO - 显示部分聚类标签数据。
2024-12-16 20:39:21,844 - INFO - 查看聚类中心（逆标准化）。
2024-12-16 20:39:21,852 - INFO - 聚类中心（逆标准化）如下：
2024-12-16 20:39:21,859 - INFO - 
           caller_count  callee_count  ...  optr_2_ratio  optr_3_ratio
Cluster 0           1.0           0.0  ...  3.333333e-01  6.666667e-01
Cluster 1           0.0           1.0  ...  5.551115e-17  2.775558e-17
Cluster 2           1.0           0.0  ...  2.500000e-01 -1.387779e-17
Cluster 3           1.0           0.0  ...  1.000000e+00 -1.387779e-17

[4 rows x 17 columns]
2024-12-16 20:39:21,859 - INFO - 开始PCA降维以便可视化。
2024-12-16 20:39:21,860 - INFO - PCA降维完成。
2024-12-16 20:39:21,860 - INFO - PCA DataFrame形状: (18, 3)
2024-12-16 20:39:21,860 - INFO - PCA DataFrame中 'cluster' 列唯一值: [3 2 0 1]
2024-12-16 20:39:21,860 - INFO - PCA DataFrame中 'cluster' 列存在NaN: 0
2024-12-16 20:39:21,860 - INFO - 将 'cluster' 列转换为字符串类型。
2024-12-16 20:39:21,966 - INFO - 聚类结果散点图已保存为 kmeans_pca_scatter.png。
2024-12-16 20:39:22,032 - INFO - 聚类分析脚本执行完成。
2024-12-16 20:41:37,929 - INFO - 开始执行聚类分析脚本。
2024-12-16 20:41:37,929 - INFO - 已设置临时目录到 D 盘。
2024-12-16 20:41:37,929 - INFO - 开始读取数据文件。
2024-12-16 20:41:39,900 - INFO - 数据读取完成，共有 1999988 行，14 列。
2024-12-16 20:41:39,900 - INFO - 开始数据预处理。
2024-12-16 20:41:44,612 - INFO - 数据预处理完成。
2024-12-16 20:41:44,778 - INFO - 检查数据中的异常值。
2024-12-16 20:41:44,942 - INFO - 删除了 raw_dur 大于 1065.0 的异常值，原始数据形状 (1999988, 14)，处理后形状 (1980010, 14)。
2024-12-16 20:41:44,942 - INFO - 开始构建特征1：通话呼叫行为。
2024-12-16 20:41:47,417 - INFO - 特征1构建完成。
2024-12-16 20:41:47,417 - INFO - 开始构建特征2：通话时刻（向量化处理）。
2024-12-16 20:41:48,752 - INFO - 特征2构建完成。
2024-12-16 20:41:48,752 - INFO - 开始构建特征3：通话时长。
2024-12-16 20:41:49,407 - INFO - 特征3构建完成。
2024-12-16 20:41:49,407 - INFO - 开始构建特征4：通话类型分布和运营商比例。
2024-12-16 20:41:50,062 - INFO - 通话类型分布特征构建完成。
2024-12-16 20:41:50,738 - INFO - 不同运营商的通话次数特征构建完成。
2024-12-16 20:41:50,738 - INFO - 开始计算运营商比例。
2024-12-16 20:41:50,755 - INFO - 运营商比例计算完成。
2024-12-16 20:41:50,828 - INFO - 所有特征构建完成。
2024-12-16 20:41:50,828 - INFO - 显示部分构建的特征数据。
2024-12-16 20:41:50,839 - INFO - 选择数值型特征进行聚类。
2024-12-16 20:41:50,881 - INFO - 选定的特征包括：['caller_count', 'callee_count', 'Early Morning', 'Morning', 'Afternoon', 'Evening', 'total_dur', 'avg_dur', 'max_dur', 'min_dur', 'call_count', 'call_type_1', 'call_type_2', 'call_type_3', 'optr_1_ratio', 'optr_2_ratio', 'optr_3_ratio']
2024-12-16 20:41:50,881 - INFO - 特征数据形状: (1672456, 17)
2024-12-16 20:41:51,034 - INFO - 重置特征数据框的索引。
2024-12-16 20:41:51,034 - INFO - 开始进行特征归一化。
2024-12-16 20:41:51,371 - INFO - 特征归一化完成。
2024-12-16 20:41:51,371 - INFO - 开始使用肘部法则确定最佳聚类数。
2024-12-16 20:41:51,373 - INFO - 正在计算 k=1 的K-Means聚类。
2024-12-16 20:41:52,413 - INFO - k=1 的SSE: 28431751.999989603
2024-12-16 20:41:52,413 - INFO - 正在计算 k=2 的K-Means聚类。
2024-12-16 20:41:54,703 - INFO - k=2 的SSE: 20108576.749355786
2024-12-16 20:41:54,703 - INFO - 正在计算 k=3 的K-Means聚类。
2024-12-16 20:41:58,624 - INFO - k=3 的SSE: 17073660.994811174
2024-12-16 20:41:58,624 - INFO - 正在计算 k=4 的K-Means聚类。
2024-12-16 20:42:03,768 - INFO - k=4 的SSE: 15519003.432333149
2024-12-16 20:42:03,768 - INFO - 正在计算 k=5 的K-Means聚类。
2024-12-16 20:42:09,242 - INFO - k=5 的SSE: 14210632.831650361
2024-12-16 20:42:09,242 - INFO - 正在计算 k=6 的K-Means聚类。
2024-12-16 20:42:15,496 - INFO - k=6 的SSE: 12913267.747142026
2024-12-16 20:42:15,496 - INFO - 正在计算 k=7 的K-Means聚类。
2024-12-16 20:42:21,934 - INFO - k=7 的SSE: 11822378.465195091
2024-12-16 20:42:21,935 - INFO - 正在计算 k=8 的K-Means聚类。
2024-12-16 20:42:29,531 - INFO - k=8 的SSE: 10845481.674466362
2024-12-16 20:42:29,532 - INFO - 正在计算 k=9 的K-Means聚类。
2024-12-16 20:42:39,409 - INFO - k=9 的SSE: 9929835.292918576
2024-12-16 20:42:39,409 - INFO - 正在计算 k=10 的K-Means聚类。
2024-12-16 20:42:49,958 - INFO - k=10 的SSE: 9206726.5957913
2024-12-16 20:42:50,035 - INFO - 肘部法则图已保存为 elbow_method.png。
2024-12-16 20:42:50,133 - INFO - 开始使用轮廓系数确定最佳聚类数。
2024-12-16 20:42:50,133 - INFO - 正在计算 k=2 的轮廓系数。
2024-12-16 20:42:50,133 - ERROR - k=2 的轮廓系数计算失败: The 'algorithm' parameter of KMeans must be a str among {'lloyd', 'elkan'}. Got 'auto' instead.
2024-12-16 20:42:50,133 - INFO - 正在计算 k=3 的轮廓系数。
2024-12-16 20:42:50,133 - ERROR - k=3 的轮廓系数计算失败: The 'algorithm' parameter of KMeans must be a str among {'lloyd', 'elkan'}. Got 'auto' instead.
2024-12-16 20:42:50,134 - INFO - 正在计算 k=4 的轮廓系数。
2024-12-16 20:42:50,134 - ERROR - k=4 的轮廓系数计算失败: The 'algorithm' parameter of KMeans must be a str among {'lloyd', 'elkan'}. Got 'auto' instead.
2024-12-16 20:42:50,134 - INFO - 正在计算 k=5 的轮廓系数。
2024-12-16 20:42:50,134 - ERROR - k=5 的轮廓系数计算失败: The 'algorithm' parameter of KMeans must be a str among {'lloyd', 'elkan'}. Got 'auto' instead.
2024-12-16 20:42:50,134 - INFO - 正在计算 k=6 的轮廓系数。
2024-12-16 20:42:50,134 - ERROR - k=6 的轮廓系数计算失败: The 'algorithm' parameter of KMeans must be a str among {'lloyd', 'elkan'}. Got 'auto' instead.
2024-12-16 20:42:50,134 - INFO - 正在计算 k=7 的轮廓系数。
2024-12-16 20:42:50,134 - ERROR - k=7 的轮廓系数计算失败: The 'algorithm' parameter of KMeans must be a str among {'lloyd', 'elkan'}. Got 'auto' instead.
2024-12-16 20:42:50,134 - INFO - 正在计算 k=8 的轮廓系数。
2024-12-16 20:42:50,134 - ERROR - k=8 的轮廓系数计算失败: The 'algorithm' parameter of KMeans must be a str among {'lloyd', 'elkan'}. Got 'auto' instead.
2024-12-16 20:42:50,134 - INFO - 正在计算 k=9 的轮廓系数。
2024-12-16 20:42:50,134 - ERROR - k=9 的轮廓系数计算失败: The 'algorithm' parameter of KMeans must be a str among {'lloyd', 'elkan'}. Got 'auto' instead.
2024-12-16 20:42:50,134 - INFO - 正在计算 k=10 的轮廓系数。
2024-12-16 20:42:50,134 - ERROR - k=10 的轮廓系数计算失败: The 'algorithm' parameter of KMeans must be a str among {'lloyd', 'elkan'}. Got 'auto' instead.
2024-12-16 20:42:50,191 - INFO - 轮廓系数图已保存为 silhouette_analysis.png。
2024-12-16 20:42:50,283 - WARNING - 没有有效的轮廓系数，无法基于轮廓系数选择最佳k。
2024-12-16 20:42:50,284 - INFO - 最终选择的最佳聚类数 k=4。
2024-12-16 20:42:50,284 - INFO - 开始应用K-Means聚类。
2024-12-16 20:42:55,529 - INFO - K-Means聚类完成。
2024-12-16 20:42:55,529 - INFO - K-Means标签数量: 1672456, 特征数据框行数: 1672456
2024-12-16 20:42:55,532 - INFO - 聚类标签已成功添加到特征数据框中。
2024-12-16 20:42:55,532 - INFO - 显示部分聚类标签数据。
2024-12-16 20:42:55,532 - INFO - 查看聚类中心（逆标准化）。
2024-12-16 20:42:55,539 - INFO - 聚类中心（逆标准化）如下：
2024-12-16 20:42:55,545 - INFO - 
           caller_count  callee_count  ...  optr_2_ratio  optr_3_ratio
Cluster 0  1.419596e+01 -1.216804e-13  ...  5.450242e-01  8.533435e-02
Cluster 1  1.568079e-12  1.617823e+00  ... -2.150224e-13  3.515244e-14
Cluster 2  2.745930e+00 -1.114664e-13  ...  5.590074e-01  8.858737e-02
Cluster 3  3.107281e+00  7.165379e-13  ...  5.416380e-01  7.851982e-02

[4 rows x 17 columns]
2024-12-16 20:42:55,545 - INFO - 开始PCA降维以便可视化。
2024-12-16 20:42:55,636 - INFO - PCA降维完成。
2024-12-16 20:42:55,636 - INFO - PCA DataFrame形状: (1672456, 3)
2024-12-16 20:42:55,641 - INFO - PCA DataFrame中 'cluster' 列唯一值: [3 0 2 1]
2024-12-16 20:42:55,643 - INFO - PCA DataFrame中 'cluster' 列存在NaN: 0
2024-12-16 20:42:55,798 - INFO - 将 'cluster' 列转换为字符串类型。
2024-12-16 20:43:25,405 - INFO - 聚类结果散点图已保存为 kmeans_pca_scatter.png。
2024-12-16 20:43:38,946 - INFO - 聚类分析脚本执行完成。
2024-12-16 21:15:43,681 - INFO - 开始执行聚类分析脚本。
2024-12-16 21:15:43,681 - INFO - 已设置临时目录到 D 盘。
2024-12-16 21:15:43,682 - INFO - 开始读取数据文件。
2024-12-16 21:15:43,683 - INFO - 数据读取完成，共有 10 行，14 列。
2024-12-16 21:15:43,683 - INFO - 开始数据预处理。
2024-12-16 21:15:43,685 - INFO - 数据预处理完成。
2024-12-16 21:15:43,685 - INFO - 检查数据中的异常值。
2024-12-16 21:15:43,686 - INFO - 删除了 raw_dur 大于 874.35 的异常值，原始数据形状 (10, 14)，处理后形状 (9, 14)。
2024-12-16 21:15:43,686 - INFO - 开始构建特征1：通话呼叫行为。
2024-12-16 21:15:43,687 - INFO - 特征1构建完成。
2024-12-16 21:15:43,687 - INFO - 开始构建特征2：通话时刻（向量化处理）。
2024-12-16 21:15:43,690 - INFO - 特征2构建完成。
2024-12-16 21:15:43,690 - INFO - 开始构建特征3：通话时长。
2024-12-16 21:15:43,692 - INFO - 特征3构建完成。
2024-12-16 21:15:43,692 - INFO - 开始构建特征4：通话类型分布和运营商比例。
2024-12-16 21:15:43,693 - INFO - 通话类型分布特征构建完成。
2024-12-16 21:15:43,694 - INFO - 不同运营商的通话次数特征构建完成。
2024-12-16 21:15:43,694 - INFO - 开始计算运营商比例。
2024-12-16 21:15:43,695 - INFO - 运营商比例计算完成。
2024-12-16 21:15:43,695 - INFO - 所有特征构建完成。
2024-12-16 21:15:43,695 - INFO - 显示部分构建的特征数据。
2024-12-16 21:15:43,705 - INFO - 选择数值型特征进行聚类。
2024-12-16 21:15:43,706 - INFO - 选定的特征包括：['caller_count', 'callee_count', 'Early Morning', 'Morning', 'Afternoon', 'Evening', 'total_dur', 'avg_dur', 'max_dur', 'min_dur', 'call_count', 'call_type_1', 'call_type_2', 'call_type_3', 'optr_1_ratio', 'optr_2_ratio', 'optr_3_ratio']
2024-12-16 21:15:43,706 - INFO - 特征数据形状: (18, 17)
2024-12-16 21:15:43,706 - INFO - 重置特征数据框的索引。
2024-12-16 21:15:43,706 - INFO - 开始进行特征归一化。
2024-12-16 21:15:43,707 - INFO - 特征归一化完成。
2024-12-16 21:15:43,707 - INFO - 开始使用肘部法则确定最佳聚类数。
2024-12-16 21:15:43,708 - ERROR - 在执行聚类分析脚本时发生错误。
Traceback (most recent call last):
  File "D:\sthgithub\BigData\code\feature.py", line 165, in <module>
    kmeans.fit(X_scaled)
  File "D:\homework\dixueds\code\venv\Lib\site-packages\sklearn\base.py", line 1466, in wrapper
    estimator._validate_params()
  File "D:\homework\dixueds\code\venv\Lib\site-packages\sklearn\base.py", line 666, in _validate_params
    validate_parameter_constraints(
  File "D:\homework\dixueds\code\venv\Lib\site-packages\sklearn\utils\_param_validation.py", line 95, in validate_parameter_constraints
    raise InvalidParameterError(
sklearn.utils._param_validation.InvalidParameterError: The 'algorithm' parameter of KMeans must be a str among {'lloyd', 'elkan'}. Got 'auto' instead.
2024-12-16 21:17:06,371 - INFO - 开始执行聚类分析脚本。
2024-12-16 21:17:06,371 - INFO - 已设置临时目录到 D 盘。
2024-12-16 21:17:06,372 - INFO - 开始读取数据文件。
2024-12-16 21:17:06,373 - INFO - 数据读取完成，共有 10 行，14 列。
2024-12-16 21:17:06,373 - INFO - 开始数据预处理。
2024-12-16 21:17:06,375 - INFO - 数据预处理完成。
2024-12-16 21:17:06,375 - INFO - 检查数据中的异常值。
2024-12-16 21:17:06,376 - INFO - 删除了 raw_dur 大于 874.35 的异常值，原始数据形状 (10, 14)，处理后形状 (9, 14)。
2024-12-16 21:17:06,376 - INFO - 开始构建特征1：通话呼叫行为。
2024-12-16 21:17:06,377 - INFO - 特征1构建完成。
2024-12-16 21:17:06,377 - INFO - 开始构建特征2：通话时刻（向量化处理）。
2024-12-16 21:17:06,380 - INFO - 特征2构建完成。
2024-12-16 21:17:06,380 - INFO - 开始构建特征3：通话时长。
2024-12-16 21:17:06,382 - INFO - 特征3构建完成。
2024-12-16 21:17:06,382 - INFO - 开始构建特征4：通话类型分布和运营商比例。
2024-12-16 21:17:06,383 - INFO - 通话类型分布特征构建完成。
2024-12-16 21:17:06,384 - INFO - 不同运营商的通话次数特征构建完成。
2024-12-16 21:17:06,384 - INFO - 开始计算运营商比例。
2024-12-16 21:17:06,385 - INFO - 运营商比例计算完成。
2024-12-16 21:17:06,385 - INFO - 所有特征构建完成。
2024-12-16 21:17:06,385 - INFO - 显示部分构建的特征数据。
2024-12-16 21:17:06,394 - INFO - 选择数值型特征进行聚类。
2024-12-16 21:17:06,394 - INFO - 选定的特征包括：['caller_count', 'callee_count', 'Early Morning', 'Morning', 'Afternoon', 'Evening', 'total_dur', 'avg_dur', 'max_dur', 'min_dur', 'call_count', 'call_type_1', 'call_type_2', 'call_type_3', 'optr_1_ratio', 'optr_2_ratio', 'optr_3_ratio']
2024-12-16 21:17:06,396 - INFO - 特征数据形状: (18, 17)
2024-12-16 21:17:06,396 - INFO - 重置特征数据框的索引。
2024-12-16 21:17:06,396 - INFO - 开始进行特征归一化。
2024-12-16 21:17:06,397 - INFO - 特征归一化完成。
2024-12-16 21:17:06,397 - INFO - 开始使用肘部法则确定最佳聚类数。
2024-12-16 21:17:07,170 - INFO - 肘部法则图已保存为 elbow_method.png。
2024-12-16 21:17:07,245 - INFO - 开始使用轮廓系数确定最佳聚类数。
2024-12-16 21:17:07,889 - INFO - 轮廓系数图已保存为 silhouette_analysis.png。
2024-12-16 21:17:07,964 - INFO - 基于轮廓系数选择的最佳聚类数 k=5，轮廓系数为 0.6576766006580732
2024-12-16 21:17:07,965 - INFO - 最终选择的最佳聚类数 k=5。
2024-12-16 21:17:07,965 - INFO - 开始应用K-Means聚类。
2024-12-16 21:17:08,027 - INFO - K-Means聚类完成。
2024-12-16 21:17:08,027 - INFO - K-Means标签数量: 18, 特征数据框行数: 18
2024-12-16 21:17:08,027 - INFO - 聚类标签已成功添加到特征数据框中。
2024-12-16 21:17:08,028 - INFO - 显示部分聚类标签数据。
2024-12-16 21:17:08,028 - INFO - 查看聚类中心（逆标准化）。
2024-12-16 21:17:08,036 - INFO - 聚类中心（逆标准化）如下：
2024-12-16 21:17:08,043 - INFO - 
           caller_count  callee_count  ...  optr_2_ratio  optr_3_ratio
Cluster 0           1.0           0.0  ...  3.333333e-01  6.666667e-01
Cluster 1           0.0           1.0  ...  5.551115e-17  2.775558e-17
Cluster 2           1.0           0.0  ...  2.775558e-17 -1.387779e-17
Cluster 3           1.0           0.0  ...  1.000000e+00 -1.387779e-17
Cluster 4           1.0           0.0  ...  5.000000e-01 -1.387779e-17

[5 rows x 17 columns]
2024-12-16 21:17:08,043 - INFO - 开始PCA降维以便可视化。
2024-12-16 21:17:08,044 - INFO - PCA降维完成。
2024-12-16 21:17:08,143 - INFO - 聚类结果散点图已保存为 kmeans_pca_scatter.png。
2024-12-16 21:17:08,222 - INFO - 聚类分析脚本执行完成。
2024-12-16 21:17:42,819 - INFO - 开始执行聚类分析脚本。
2024-12-16 21:17:42,819 - INFO - 已设置临时目录到 D 盘。
2024-12-16 21:17:42,819 - INFO - 开始读取数据文件。
2024-12-16 21:17:44,793 - INFO - 数据读取完成，共有 1999988 行，14 列。
2024-12-16 21:17:44,793 - INFO - 开始数据预处理。
2024-12-16 21:17:49,586 - INFO - 数据预处理完成。
2024-12-16 21:17:49,753 - INFO - 检查数据中的异常值。
2024-12-16 21:17:49,910 - INFO - 删除了 raw_dur 大于 1065.0 的异常值，原始数据形状 (1999988, 14)，处理后形状 (1980010, 14)。
2024-12-16 21:17:49,911 - INFO - 开始构建特征1：通话呼叫行为。
2024-12-16 21:17:52,402 - INFO - 特征1构建完成。
2024-12-16 21:17:52,402 - INFO - 开始构建特征2：通话时刻（向量化处理）。
2024-12-16 21:17:53,716 - INFO - 特征2构建完成。
2024-12-16 21:17:53,717 - INFO - 开始构建特征3：通话时长。
2024-12-16 21:17:54,383 - INFO - 特征3构建完成。
2024-12-16 21:17:54,383 - INFO - 开始构建特征4：通话类型分布和运营商比例。
2024-12-16 21:17:55,032 - INFO - 通话类型分布特征构建完成。
2024-12-16 21:17:55,729 - INFO - 不同运营商的通话次数特征构建完成。
2024-12-16 21:17:55,729 - INFO - 开始计算运营商比例。
2024-12-16 21:17:55,750 - INFO - 运营商比例计算完成。
2024-12-16 21:17:55,825 - INFO - 所有特征构建完成。
2024-12-16 21:17:55,826 - INFO - 显示部分构建的特征数据。
2024-12-16 21:17:55,837 - INFO - 选择数值型特征进行聚类。
2024-12-16 21:17:55,879 - INFO - 选定的特征包括：['caller_count', 'callee_count', 'Early Morning', 'Morning', 'Afternoon', 'Evening', 'total_dur', 'avg_dur', 'max_dur', 'min_dur', 'call_count', 'call_type_1', 'call_type_2', 'call_type_3', 'optr_1_ratio', 'optr_2_ratio', 'optr_3_ratio']
2024-12-16 21:17:55,880 - INFO - 特征数据形状: (1672456, 17)
2024-12-16 21:17:56,039 - INFO - 重置特征数据框的索引。
2024-12-16 21:17:56,040 - INFO - 开始进行特征归一化。
2024-12-16 21:17:56,365 - INFO - 特征归一化完成。
2024-12-16 21:17:56,365 - INFO - 开始使用肘部法则确定最佳聚类数。
2024-12-16 21:18:54,842 - INFO - 肘部法则图已保存为 elbow_method.png。
2024-12-16 21:18:54,921 - INFO - 开始使用轮廓系数确定最佳聚类数。
2024-12-16 21:26:04,559 - INFO - 开始执行聚类分析脚本。
2024-12-16 21:26:04,559 - INFO - 已设置临时目录到 D 盘。
2024-12-16 21:26:04,559 - INFO - 开始读取数据文件。
2024-12-16 21:26:04,561 - INFO - 数据读取完成，共有 10 行，14 列。
2024-12-16 21:26:04,561 - INFO - 开始数据预处理。
2024-12-16 21:26:04,563 - INFO - 数据预处理完成。
2024-12-16 21:26:04,563 - INFO - 检查数据中的异常值。
2024-12-16 21:26:04,564 - INFO - 删除raw_dur大于 874.35 的异常值，原始形状 (10, 14)，处理后 (9, 14)。
2024-12-16 21:26:04,564 - INFO - 开始特征构建。
2024-12-16 21:26:04,573 - INFO - 特征构建完成。
2024-12-16 21:26:04,583 - INFO - 特征形状: (18, 17)
2024-12-16 21:26:04,583 - INFO - 开始标准化。
2024-12-16 21:26:04,584 - INFO - 标准化完成。
2024-12-16 21:26:04,584 - INFO - 开始PCA降维到50维。
2024-12-16 21:26:04,585 - ERROR - 执行聚类分析脚本时发生错误。
Traceback (most recent call last):
  File "D:\sthgithub\BigData\code\feature.py", line 130, in <module>
    X_pca = pca.fit_transform(X_scaled)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\homework\dixueds\code\venv\Lib\site-packages\sklearn\utils\_set_output.py", line 316, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\homework\dixueds\code\venv\Lib\site-packages\sklearn\base.py", line 1473, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\homework\dixueds\code\venv\Lib\site-packages\sklearn\decomposition\_pca.py", line 474, in fit_transform
    U, S, _, X, x_is_centered, xp = self._fit(X)
                                    ^^^^^^^^^^^^
  File "D:\homework\dixueds\code\venv\Lib\site-packages\sklearn\decomposition\_pca.py", line 547, in _fit
    return self._fit_full(X, n_components, xp, is_array_api_compliant)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\homework\dixueds\code\venv\Lib\site-packages\sklearn\decomposition\_pca.py", line 561, in _fit_full
    raise ValueError(
ValueError: n_components=50 must be between 0 and min(n_samples, n_features)=17 with svd_solver='full'
2024-12-16 21:28:48,567 - INFO - 开始执行聚类分析脚本。
2024-12-16 21:28:48,567 - INFO - 已设置临时目录到 D 盘。
2024-12-16 21:28:48,567 - INFO - 开始读取数据文件。
2024-12-16 21:28:48,569 - INFO - 数据读取完成，共有 10 行，14 列。
2024-12-16 21:28:48,569 - INFO - 开始数据预处理。
2024-12-16 21:28:48,570 - INFO - 数据预处理完成。
2024-12-16 21:28:48,570 - INFO - 检查数据中的异常值。
2024-12-16 21:28:48,571 - INFO - 删除raw_dur大于 874.35 的异常值，原始形状 (10, 14)，处理后 (9, 14)。
2024-12-16 21:28:48,571 - INFO - 开始特征构建。
2024-12-16 21:28:48,579 - INFO - 特征构建完成。
2024-12-16 21:28:48,588 - INFO - 特征形状: (18, 17)
2024-12-16 21:28:48,589 - INFO - 开始标准化。
2024-12-16 21:28:48,590 - INFO - 标准化完成。
2024-12-16 21:28:48,590 - INFO - 开始PCA降维到17维。
2024-12-16 21:28:48,591 - INFO - PCA降维完成。
2024-12-16 21:28:48,591 - INFO - 使用肘部法则确定k。
2024-12-16 21:28:49,810 - INFO - 肘部法则图已保存为 elbow_method.png。
2024-12-16 21:28:49,880 - INFO - 使用轮廓系数确定k。
2024-12-16 21:28:50,868 - INFO - 轮廓系数图已保存为 silhouette_analysis.png。
2024-12-16 21:28:50,938 - INFO - 基于轮廓系数选择 k=7, score=0.6342816305353556
2024-12-16 21:28:50,939 - INFO - 最终选择的k=7。
2024-12-16 21:28:50,939 - INFO - 对全量数据使用最终k进行聚类。
2024-12-16 21:28:51,038 - INFO - MiniBatchKMeans聚类完成。
2024-12-16 21:28:51,038 - INFO - 聚类标签已加入特征数据框。
2024-12-16 21:28:51,039 - INFO - 显示部分聚类标签数据。
2024-12-16 21:28:51,039 - INFO - 查看聚类中心（逆标准化）。
2024-12-16 21:28:51,050 - INFO - 聚类中心（逆标准化）如下：
2024-12-16 21:28:51,059 - INFO - 
           caller_count  callee_count  ...  optr_2_ratio  optr_3_ratio
Cluster 0  1.221245e-15  1.000000e+00  ...  4.440892e-16  2.220446e-16
Cluster 1  1.000000e+00  1.332268e-15  ...  1.000000e+00  9.575674e-16
Cluster 2  1.000000e+00  1.110223e-16  ...  2.982456e-01  7.017544e-01
Cluster 3  1.000000e+00  4.440892e-16  ...  5.273559e-16  2.775558e-16
Cluster 4  1.000000e+00  1.665335e-15  ... -8.326673e-17  1.026956e-15
Cluster 5  1.000000e+00 -1.110223e-15  ...  1.000000e+00 -4.579670e-16
Cluster 6  1.000000e+00  1.110223e-15  ...  1.000000e+00 -7.910339e-16

[7 rows x 17 columns]
2024-12-16 21:28:51,059 - INFO - PCA降维可视化最终聚类结果。
2024-12-16 21:28:51,159 - INFO - 聚类结果散点图已保存为 kmeans_pca_scatter.png。
2024-12-16 21:28:51,228 - INFO - 聚类分析完成。
2024-12-16 21:29:09,761 - INFO - 开始执行聚类分析脚本。
2024-12-16 21:29:09,761 - INFO - 已设置临时目录到 D 盘。
2024-12-16 21:29:09,761 - INFO - 开始读取数据文件。
2024-12-16 21:29:11,732 - INFO - 数据读取完成，共有 1999988 行，14 列。
2024-12-16 21:29:11,733 - INFO - 开始数据预处理。
2024-12-16 21:29:16,588 - INFO - 数据预处理完成。
2024-12-16 21:29:16,754 - INFO - 检查数据中的异常值。
2024-12-16 21:29:16,923 - INFO - 删除raw_dur大于 1065.0 的异常值，原始形状 (1999988, 14)，处理后 (1980010, 14)。
2024-12-16 21:29:16,923 - INFO - 开始特征构建。
2024-12-16 21:29:22,881 - INFO - 特征构建完成。
2024-12-16 21:29:22,933 - INFO - 特征形状: (1672456, 17)
2024-12-16 21:29:23,081 - INFO - 开始标准化。
2024-12-16 21:29:23,418 - INFO - 标准化完成。
2024-12-16 21:29:23,418 - INFO - 开始PCA降维到17维。
2024-12-16 21:29:23,568 - INFO - PCA降维完成。
2024-12-16 21:29:23,568 - INFO - 使用肘部法则确定k。
2024-12-16 21:29:25,583 - INFO - 肘部法则图已保存为 elbow_method.png。
2024-12-16 21:29:25,652 - INFO - 使用轮廓系数确定k。
2024-12-16 21:31:15,340 - INFO - 开始执行聚类分析脚本。
2024-12-16 21:31:15,340 - INFO - 已设置临时目录到 D 盘。
2024-12-16 21:31:15,340 - INFO - 开始读取数据文件。
2024-12-16 21:31:17,345 - INFO - 数据读取完成，共有 1999988 行，14 列。
2024-12-16 21:31:17,345 - INFO - 开始数据预处理。
2024-12-16 21:31:22,341 - INFO - 数据预处理完成。
2024-12-16 21:31:22,517 - INFO - 检查数据中的异常值。
2024-12-16 21:31:22,693 - INFO - 删除了 raw_dur 大于 1065.0 的异常值，原始数据形状 (1999988, 14)，处理后形状 (1980010, 14)。
2024-12-16 21:31:22,693 - INFO - 开始构建特征1：通话呼叫行为。
2024-12-16 21:31:25,430 - INFO - 特征1构建完成。
2024-12-16 21:31:25,430 - INFO - 开始构建特征2：通话时刻（向量化处理）。
2024-12-16 21:31:26,774 - INFO - 特征2构建完成。
2024-12-16 21:31:26,774 - INFO - 开始构建特征3：通话时长。
2024-12-16 21:31:27,457 - INFO - 特征3构建完成。
2024-12-16 21:31:27,458 - INFO - 开始构建特征4：通话类型分布和运营商比例。
2024-12-16 21:31:28,119 - INFO - 通话类型分布特征构建完成。
2024-12-16 21:31:28,809 - INFO - 不同运营商的通话次数特征构建完成。
2024-12-16 21:31:28,809 - INFO - 开始计算运营商比例。
2024-12-16 21:31:28,827 - INFO - 运营商比例计算完成。
2024-12-16 21:31:28,907 - INFO - 所有特征构建完成。
2024-12-16 21:31:28,907 - INFO - 显示部分构建的特征数据。
2024-12-16 21:31:28,918 - INFO - 选择数值型特征进行聚类。
2024-12-16 21:31:28,960 - INFO - 选定的特征包括：['caller_count', 'callee_count', 'Early Morning', 'Morning', 'Afternoon', 'Evening', 'total_dur', 'avg_dur', 'max_dur', 'min_dur', 'call_count', 'call_type_1', 'call_type_2', 'call_type_3', 'optr_1_ratio', 'optr_2_ratio', 'optr_3_ratio']
2024-12-16 21:31:28,960 - INFO - 特征数据形状: (1672456, 17)
2024-12-16 21:31:29,127 - INFO - 重置特征数据框的索引。
2024-12-16 21:31:29,127 - INFO - 开始进行特征归一化。
2024-12-16 21:31:29,458 - INFO - 特征归一化完成。
2024-12-16 21:31:29,458 - INFO - 开始使用肘部法则确定最佳聚类数。
2024-12-16 21:31:29,460 - INFO - 正在计算 k=1 的K-Means聚类。
2024-12-16 21:31:29,461 - ERROR - 在执行聚类分析脚本时发生错误。
Traceback (most recent call last):
  File "D:\sthgithub\BigData\code\feature.py", line 179, in <module>
    kmeans.fit(X_scaled)
  File "D:\homework\dixueds\code\venv\Lib\site-packages\sklearn\base.py", line 1466, in wrapper
    estimator._validate_params()
  File "D:\homework\dixueds\code\venv\Lib\site-packages\sklearn\base.py", line 666, in _validate_params
    validate_parameter_constraints(
  File "D:\homework\dixueds\code\venv\Lib\site-packages\sklearn\utils\_param_validation.py", line 95, in validate_parameter_constraints
    raise InvalidParameterError(
sklearn.utils._param_validation.InvalidParameterError: The 'algorithm' parameter of KMeans must be a str among {'lloyd', 'elkan'}. Got 'auto' instead.
2024-12-16 21:32:44,249 - INFO - 开始执行聚类分析脚本。
2024-12-16 21:32:44,249 - INFO - 已设置临时目录到 D 盘。
2024-12-16 21:32:44,249 - INFO - 开始读取数据文件。
2024-12-16 21:32:44,251 - INFO - 数据读取完成，共有 10 行，14 列。
2024-12-16 21:32:44,251 - INFO - 开始数据预处理。
2024-12-16 21:32:44,252 - INFO - 数据预处理完成。
2024-12-16 21:32:44,252 - INFO - 检查数据中的异常值。
2024-12-16 21:32:44,254 - INFO - 删除了 raw_dur 大于 874.35 的异常值，原始数据形状 (10, 14)，处理后形状 (9, 14)。
2024-12-16 21:32:44,254 - INFO - 开始构建特征1：通话呼叫行为。
2024-12-16 21:32:44,255 - INFO - 特征1构建完成。
2024-12-16 21:32:44,255 - INFO - 开始构建特征2：通话时刻（向量化处理）。
2024-12-16 21:32:44,258 - INFO - 特征2构建完成。
2024-12-16 21:32:44,258 - INFO - 开始构建特征3：通话时长。
2024-12-16 21:32:44,259 - INFO - 特征3构建完成。
2024-12-16 21:32:44,259 - INFO - 开始构建特征4：通话类型分布和运营商比例。
2024-12-16 21:32:44,261 - INFO - 通话类型分布特征构建完成。
2024-12-16 21:32:44,262 - INFO - 不同运营商的通话次数特征构建完成。
2024-12-16 21:32:44,262 - INFO - 开始计算运营商比例。
2024-12-16 21:32:44,262 - INFO - 运营商比例计算完成。
2024-12-16 21:32:44,263 - INFO - 所有特征构建完成。
2024-12-16 21:32:44,263 - INFO - 显示部分构建的特征数据。
2024-12-16 21:32:44,272 - INFO - 选择数值型特征进行聚类。
2024-12-16 21:32:44,272 - INFO - 选定的特征包括：['caller_count', 'callee_count', 'Early Morning', 'Morning', 'Afternoon', 'Evening', 'total_dur', 'avg_dur', 'max_dur', 'min_dur', 'call_count', 'call_type_1', 'call_type_2', 'call_type_3', 'optr_1_ratio', 'optr_2_ratio', 'optr_3_ratio']
2024-12-16 21:32:44,272 - INFO - 特征数据形状: (18, 17)
2024-12-16 21:32:44,273 - INFO - 重置特征数据框的索引。
2024-12-16 21:32:44,273 - INFO - 开始进行特征归一化。
2024-12-16 21:32:44,274 - INFO - 特征归一化完成。
2024-12-16 21:32:44,274 - INFO - 开始使用肘部法则确定最佳聚类数。
2024-12-16 21:32:44,275 - INFO - 正在计算 k=1 的K-Means聚类。
2024-12-16 21:32:44,440 - INFO - k=1 的SSE: 306.00000000000006
2024-12-16 21:32:44,440 - INFO - 正在计算 k=2 的K-Means聚类。
2024-12-16 21:32:44,514 - INFO - k=2 的SSE: 164.37321160482753
2024-12-16 21:32:44,515 - INFO - 正在计算 k=3 的K-Means聚类。
2024-12-16 21:32:44,577 - INFO - k=3 的SSE: 111.23087382284699
2024-12-16 21:32:44,577 - INFO - 正在计算 k=4 的K-Means聚类。
2024-12-16 21:32:44,633 - INFO - k=4 的SSE: 79.19151401860049
2024-12-16 21:32:44,633 - INFO - 正在计算 k=5 的K-Means聚类。
2024-12-16 21:32:44,685 - INFO - k=5 的SSE: 56.40594888767571
2024-12-16 21:32:44,686 - INFO - 正在计算 k=6 的K-Means聚类。
2024-12-16 21:32:44,739 - INFO - k=6 的SSE: 40.62610208816705
2024-12-16 21:32:44,739 - INFO - 正在计算 k=7 的K-Means聚类。
2024-12-16 21:32:44,796 - INFO - k=7 的SSE: 25.418515909844217
2024-12-16 21:32:44,796 - INFO - 正在计算 k=8 的K-Means聚类。
2024-12-16 21:32:44,849 - INFO - k=8 的SSE: 11.725658766987074
2024-12-16 21:32:44,849 - INFO - 正在计算 k=9 的K-Means聚类。
2024-12-16 21:32:44,902 - INFO - k=9 的SSE: 0.0011600928074245913
2024-12-16 21:32:44,902 - INFO - 正在计算 k=10 的K-Means聚类。
2024-12-16 21:32:44,955 - INFO - k=10 的SSE: 2.2186712959340957e-30
2024-12-16 21:32:45,077 - INFO - 肘部法则图已保存为 elbow_method.png。
2024-12-16 21:32:45,146 - INFO - 开始使用轮廓系数确定最佳聚类数。
2024-12-16 21:32:45,146 - INFO - 正在计算 k=2 的轮廓系数。
2024-12-16 21:32:45,227 - INFO - k=2 的轮廓系数: 0.5517408295714957
2024-12-16 21:32:45,227 - INFO - 正在计算 k=3 的轮廓系数。
2024-12-16 21:32:45,304 - INFO - k=3 的轮廓系数: 0.5927138728508474
2024-12-16 21:32:45,304 - INFO - 正在计算 k=4 的轮廓系数。
2024-12-16 21:32:45,373 - INFO - k=4 的轮廓系数: 0.6137711297939239
2024-12-16 21:32:45,373 - INFO - 正在计算 k=5 的轮廓系数。
2024-12-16 21:32:45,438 - INFO - k=5 的轮廓系数: 0.6576766006580732
2024-12-16 21:32:45,438 - INFO - 正在计算 k=6 的轮廓系数。
2024-12-16 21:32:45,500 - INFO - k=6 的轮廓系数: 0.6426590645784659
2024-12-16 21:32:45,500 - INFO - 正在计算 k=7 的轮廓系数。
2024-12-16 21:32:45,559 - INFO - k=7 的轮廓系数: 0.6240510285190511
2024-12-16 21:32:45,560 - INFO - 正在计算 k=8 的轮廓系数。
2024-12-16 21:32:45,616 - INFO - k=8 的轮廓系数: 0.6197665016330188
2024-12-16 21:32:45,616 - INFO - 正在计算 k=9 的轮廓系数。
2024-12-16 21:32:45,673 - INFO - k=9 的轮廓系数: 0.6101159831030315
2024-12-16 21:32:45,673 - INFO - 正在计算 k=10 的轮廓系数。
2024-12-16 21:32:45,734 - INFO - k=10 的轮廓系数: 0.5
2024-12-16 21:32:45,806 - INFO - 轮廓系数图已保存为 silhouette_analysis.png。
2024-12-16 21:32:45,874 - INFO - 基于轮廓系数选择的最佳聚类数 k=5，轮廓系数为 0.6576766006580732
2024-12-16 21:32:45,874 - INFO - 最终选择的最佳聚类数 k=5。
2024-12-16 21:32:45,874 - INFO - 开始应用K-Means聚类。
2024-12-16 21:32:45,954 - INFO - K-Means聚类完成。
2024-12-16 21:32:45,954 - INFO - K-Means标签数量: 18, 特征数据框行数: 18
2024-12-16 21:32:45,954 - INFO - 聚类标签已成功添加到特征数据框中。
2024-12-16 21:32:45,955 - INFO - 显示部分聚类标签数据。
2024-12-16 21:32:45,955 - INFO - 查看聚类中心（逆标准化）。
2024-12-16 21:32:45,964 - INFO - 聚类中心（逆标准化）如下：
2024-12-16 21:32:45,973 - INFO - 
           caller_count  callee_count  ...  optr_2_ratio  optr_3_ratio
Cluster 0           1.0           0.0  ...  3.333333e-01  6.666667e-01
Cluster 1           0.0           1.0  ...  5.551115e-17  2.775558e-17
Cluster 2           1.0           0.0  ...  2.775558e-17 -1.387779e-17
Cluster 3           1.0           0.0  ...  1.000000e+00 -1.387779e-17
Cluster 4           1.0           0.0  ...  5.000000e-01 -1.387779e-17

[5 rows x 17 columns]
2024-12-16 21:32:45,973 - INFO - 开始PCA降维以便可视化。
2024-12-16 21:32:45,975 - INFO - PCA降维完成。
2024-12-16 21:32:45,975 - INFO - PCA DataFrame形状: (18, 3)
2024-12-16 21:32:45,975 - INFO - PCA DataFrame中 'cluster' 列唯一值: [3 2 0 4 1]
2024-12-16 21:32:45,975 - INFO - PCA DataFrame中 'cluster' 列存在NaN: 0
2024-12-16 21:32:45,975 - INFO - 将 'cluster' 列转换为字符串类型。
2024-12-16 21:32:46,071 - INFO - 聚类结果散点图已保存为 kmeans_pca_scatter.png。
2024-12-16 21:32:46,137 - INFO - 聚类分析脚本执行完成。
2024-12-16 21:33:12,318 - INFO - 开始执行聚类分析脚本。
2024-12-16 21:33:12,318 - INFO - 已设置临时目录到 D 盘。
2024-12-16 21:33:12,318 - INFO - 开始读取数据文件。
2024-12-16 21:33:14,279 - INFO - 数据读取完成，共有 1999988 行，14 列。
2024-12-16 21:33:14,279 - INFO - 开始数据预处理。
2024-12-16 21:33:19,112 - INFO - 数据预处理完成。
2024-12-16 21:33:19,275 - INFO - 检查数据中的异常值。
2024-12-16 21:33:19,438 - INFO - 删除了 raw_dur 大于 1065.0 的异常值，原始数据形状 (1999988, 14)，处理后形状 (1980010, 14)。
2024-12-16 21:33:19,438 - INFO - 开始构建特征1：通话呼叫行为。
2024-12-16 21:33:21,905 - INFO - 特征1构建完成。
2024-12-16 21:33:21,905 - INFO - 开始构建特征2：通话时刻（向量化处理）。
2024-12-16 21:33:23,241 - INFO - 特征2构建完成。
2024-12-16 21:33:23,241 - INFO - 开始构建特征3：通话时长。
2024-12-16 21:33:23,917 - INFO - 特征3构建完成。
2024-12-16 21:33:23,918 - INFO - 开始构建特征4：通话类型分布和运营商比例。
2024-12-16 21:33:24,581 - INFO - 通话类型分布特征构建完成。
2024-12-16 21:33:25,267 - INFO - 不同运营商的通话次数特征构建完成。
2024-12-16 21:33:25,267 - INFO - 开始计算运营商比例。
2024-12-16 21:33:25,286 - INFO - 运营商比例计算完成。
2024-12-16 21:33:25,363 - INFO - 所有特征构建完成。
2024-12-16 21:33:25,363 - INFO - 显示部分构建的特征数据。
2024-12-16 21:33:25,374 - INFO - 选择数值型特征进行聚类。
2024-12-16 21:33:25,418 - INFO - 选定的特征包括：['caller_count', 'callee_count', 'Early Morning', 'Morning', 'Afternoon', 'Evening', 'total_dur', 'avg_dur', 'max_dur', 'min_dur', 'call_count', 'call_type_1', 'call_type_2', 'call_type_3', 'optr_1_ratio', 'optr_2_ratio', 'optr_3_ratio']
2024-12-16 21:33:25,418 - INFO - 特征数据形状: (1672456, 17)
2024-12-16 21:33:25,575 - INFO - 重置特征数据框的索引。
2024-12-16 21:33:25,575 - INFO - 开始进行特征归一化。
2024-12-16 21:33:25,911 - INFO - 特征归一化完成。
2024-12-16 21:33:25,911 - INFO - 开始使用肘部法则确定最佳聚类数。
2024-12-16 21:33:25,913 - INFO - 正在计算 k=1 的K-Means聚类。
2024-12-16 21:33:26,909 - INFO - k=1 的SSE: 28431751.999989603
2024-12-16 21:33:26,909 - INFO - 正在计算 k=2 的K-Means聚类。
2024-12-16 21:33:29,214 - INFO - k=2 的SSE: 20108576.749355786
2024-12-16 21:33:29,215 - INFO - 正在计算 k=3 的K-Means聚类。
2024-12-16 21:33:33,133 - INFO - k=3 的SSE: 17073660.994811174
2024-12-16 21:33:33,133 - INFO - 正在计算 k=4 的K-Means聚类。
2024-12-16 21:33:38,266 - INFO - k=4 的SSE: 15519003.432333149
2024-12-16 21:33:38,266 - INFO - 正在计算 k=5 的K-Means聚类。
2024-12-16 21:33:43,776 - INFO - k=5 的SSE: 14210632.831650361
2024-12-16 21:33:43,776 - INFO - 正在计算 k=6 的K-Means聚类。
2024-12-16 21:33:49,998 - INFO - k=6 的SSE: 12913267.747142026
2024-12-16 21:33:49,998 - INFO - 正在计算 k=7 的K-Means聚类。
2024-12-16 21:33:56,365 - INFO - k=7 的SSE: 11822378.465195091
2024-12-16 21:33:56,365 - INFO - 正在计算 k=8 的K-Means聚类。
2024-12-16 21:34:03,789 - INFO - k=8 的SSE: 10845481.674466362
2024-12-16 21:34:03,790 - INFO - 正在计算 k=9 的K-Means聚类。
2024-12-16 21:34:13,474 - INFO - k=9 的SSE: 9929835.292918576
2024-12-16 21:34:13,475 - INFO - 正在计算 k=10 的K-Means聚类。
2024-12-16 21:34:23,964 - INFO - k=10 的SSE: 9206726.5957913
2024-12-16 21:34:24,040 - INFO - 肘部法则图已保存为 elbow_method.png。
2024-12-16 21:34:24,124 - INFO - 开始使用轮廓系数确定最佳聚类数。
2024-12-16 21:34:24,124 - INFO - 正在计算 k=2 的轮廓系数。
2024-12-16 21:48:33,489 - INFO - 开始执行聚类分析脚本。
2024-12-16 21:48:33,489 - INFO - 已设置临时目录到 D 盘。
2024-12-16 21:48:33,489 - INFO - 开始读取数据文件。
2024-12-16 21:48:33,491 - INFO - 数据读取完成，共有 10 行，14 列。
2024-12-16 21:48:33,491 - INFO - 开始数据预处理。
2024-12-16 21:48:33,493 - INFO - 数据预处理完成。
2024-12-16 21:48:33,493 - INFO - 检查数据中的异常值。
2024-12-16 21:48:33,494 - INFO - 删除了 raw_dur > 874.35 的异常值，原始形状 (10, 14)，处理后 (9, 14)。
2024-12-16 21:48:33,494 - INFO - 开始构建特征1：通话呼叫行为。
2024-12-16 21:48:33,495 - INFO - 特征1构建完成。
2024-12-16 21:48:33,495 - INFO - 开始构建特征2：通话时刻。
2024-12-16 21:48:33,498 - INFO - 特征2构建完成。
2024-12-16 21:48:33,498 - INFO - 开始构建特征3：通话时长。
2024-12-16 21:48:33,499 - INFO - 特征3构建完成。
2024-12-16 21:48:33,499 - INFO - 开始构建特征4：通话类型分布和运营商比例。
2024-12-16 21:48:33,501 - INFO - 通话类型分布特征构建完成。
2024-12-16 21:48:33,502 - INFO - 不同运营商通话次数特征构建完成。
2024-12-16 21:48:33,503 - INFO - 所有特征构建完成。
2024-12-16 21:48:33,512 - INFO - 选择数值型特征进行聚类。
2024-12-16 21:48:33,512 - INFO - 特征数据形状: (18, 17)
2024-12-16 21:48:33,514 - INFO - 重置特征数据框的索引。
2024-12-16 21:48:33,514 - INFO - 开始进行特征归一化。
2024-12-16 21:48:33,514 - INFO - 特征归一化完成。
2024-12-16 21:48:33,514 - INFO - PCA降维
2024-12-16 21:48:33,515 - INFO - PCA降维到 17 维完成。
2024-12-16 21:48:33,515 - INFO - 开始使用肘部法则确定最佳聚类数。
2024-12-16 21:48:34,740 - INFO - 肘部法则图已保存为 elbow_method.png。
2024-12-16 21:48:34,807 - INFO - 为计算轮廓系数进行抽样。
2024-12-16 21:48:34,816 - INFO - 开始使用轮廓系数确定最佳聚类数（基于抽样数据）。
2024-12-16 21:48:34,868 - INFO - 轮廓系数图已保存为 silhouette_analysis.png。
2024-12-16 21:48:34,928 - WARNING - 没有有效轮廓系数，使用默认k=4。
2024-12-16 21:48:34,928 - INFO - 最终选择的最佳k=4。
2024-12-16 21:48:34,928 - INFO - 使用 k=4 对全量数据进行MiniBatchKMeans聚类。
2024-12-16 21:48:35,046 - INFO - 全量数据聚类完成。
2024-12-16 21:48:35,046 - INFO - K-Means标签数量: 18, 特征数据框行数: 18
2024-12-16 21:48:35,046 - INFO - 聚类标签已成功添加到特征数据框中。
2024-12-16 21:48:35,047 - INFO - 显示部分聚类标签数据。
2024-12-16 21:48:35,047 - INFO - 恢复聚类中心(逆PCA+逆标准化)。
2024-12-16 21:48:35,057 - INFO - 聚类中心（逆标准化）如下：
2024-12-16 21:48:35,067 - INFO - 
           caller_count  callee_count  ...  optr_2_ratio  optr_3_ratio
Cluster 0 -2.220446e-16  1.000000e+00  ... -2.220446e-16  1.387779e-17
Cluster 1  1.000000e+00  6.661338e-16  ...  3.255814e-01  6.744186e-01
Cluster 2  1.000000e+00  2.220446e-16  ...  3.909774e-01  9.853229e-16
Cluster 3  1.000000e+00  1.165734e-15  ...  1.000000e+00 -7.216450e-16

[4 rows x 17 columns]
2024-12-16 21:48:35,068 - INFO - PCA降维后可视化聚类结果（前两维）。
2024-12-16 21:48:35,158 - INFO - 聚类结果散点图已保存为 kmeans_pca_scatter.png。
2024-12-16 21:48:35,224 - INFO - 聚类分析完成。
2024-12-16 21:49:08,579 - INFO - 开始执行聚类分析脚本。
2024-12-16 21:49:08,579 - INFO - 已设置临时目录到 D 盘。
2024-12-16 21:49:08,579 - INFO - 开始读取数据文件。
2024-12-16 21:49:10,564 - INFO - 数据读取完成，共有 1999988 行，14 列。
2024-12-16 21:49:10,565 - INFO - 开始数据预处理。
2024-12-16 21:49:15,599 - INFO - 数据预处理完成。
2024-12-16 21:49:15,769 - INFO - 检查数据中的异常值。
2024-12-16 21:49:15,926 - INFO - 删除了 raw_dur > 1065.0 的异常值，原始形状 (1999988, 14)，处理后 (1980010, 14)。
2024-12-16 21:49:15,926 - INFO - 开始构建特征1：通话呼叫行为。
2024-12-16 21:49:18,540 - INFO - 特征1构建完成。
2024-12-16 21:49:18,540 - INFO - 开始构建特征2：通话时刻。
2024-12-16 21:49:19,874 - INFO - 特征2构建完成。
2024-12-16 21:49:19,874 - INFO - 开始构建特征3：通话时长。
2024-12-16 21:49:20,541 - INFO - 特征3构建完成。
2024-12-16 21:49:20,541 - INFO - 开始构建特征4：通话类型分布和运营商比例。
2024-12-16 21:49:21,192 - INFO - 通话类型分布特征构建完成。
2024-12-16 21:49:21,869 - INFO - 不同运营商通话次数特征构建完成。
2024-12-16 21:49:21,959 - INFO - 所有特征构建完成。
2024-12-16 21:49:21,969 - INFO - 选择数值型特征进行聚类。
2024-12-16 21:49:22,010 - INFO - 特征数据形状: (1672456, 17)
2024-12-16 21:49:22,163 - INFO - 重置特征数据框的索引。
2024-12-16 21:49:22,163 - INFO - 开始进行特征归一化。
2024-12-16 21:49:22,500 - INFO - 特征归一化完成。
2024-12-16 21:49:22,500 - INFO - PCA降维
2024-12-16 21:49:22,640 - INFO - PCA降维到 17 维完成。
2024-12-16 21:49:22,640 - INFO - 开始使用肘部法则确定最佳聚类数。
2024-12-16 21:49:24,695 - INFO - 肘部法则图已保存为 elbow_method.png。
2024-12-16 21:49:24,770 - INFO - 为计算轮廓系数进行抽样。
2024-12-16 21:49:24,808 - INFO - 开始使用轮廓系数确定最佳聚类数（基于抽样数据）。
2024-12-16 21:49:36,121 - INFO - 轮廓系数图已保存为 silhouette_analysis.png。
2024-12-16 21:49:36,186 - INFO - 基于抽样数据的轮廓系数选择 k=9, 得分=0.7656
2024-12-16 21:49:36,186 - INFO - 最终选择的最佳k=9。
2024-12-16 21:49:36,186 - INFO - 使用 k=9 对全量数据进行MiniBatchKMeans聚类。
2024-12-16 21:49:36,393 - INFO - 全量数据聚类完成。
2024-12-16 21:49:36,393 - INFO - K-Means标签数量: 1672456, 特征数据框行数: 1672456
2024-12-16 21:49:36,395 - INFO - 聚类标签已成功添加到特征数据框中。
2024-12-16 21:49:36,395 - INFO - 显示部分聚类标签数据。
2024-12-16 21:49:36,396 - INFO - 恢复聚类中心(逆PCA+逆标准化)。
2024-12-16 21:49:36,412 - INFO - 聚类中心（逆标准化）如下：
2024-12-16 21:49:36,422 - INFO - 
           caller_count  callee_count  ...  optr_2_ratio  optr_3_ratio
Cluster 0  4.840572e-14  2.017796e+00  ...  2.775558e-16 -2.428613e-16
Cluster 1  9.310903e+00  1.088019e-14  ...  5.660090e-01  7.251476e-02
Cluster 2  3.284504e+00  1.554312e-14  ...  5.892751e-01  5.124669e-02
Cluster 3  2.713098e+00 -2.198242e-14  ...  1.973245e-01  6.684850e-01
Cluster 4  2.592345e+00  6.661338e-16  ...  9.044589e-01  2.173692e-02
Cluster 5  2.432519e+00  7.993606e-15  ...  1.725621e-01  1.043343e-02
Cluster 6  1.776357e-15  4.322870e+00  ... -3.885781e-16 -7.632783e-17
Cluster 7  2.350259e+01  2.331468e-14  ...  5.190834e-01  9.672439e-02
Cluster 8 -2.038369e-13  1.000000e+00  ... -1.129652e-14 -4.891920e-16

[9 rows x 17 columns]
2024-12-16 21:49:36,422 - INFO - PCA降维后可视化聚类结果（前两维）。
2024-12-16 21:50:06,518 - INFO - 聚类结果散点图已保存为 kmeans_pca_scatter.png。
2024-12-16 21:50:20,277 - INFO - 聚类分析完成。
2024-12-16 21:55:39,252 - INFO - 开始执行聚类分析脚本。
2024-12-16 21:55:39,252 - INFO - 已设置临时目录到 D 盘。
2024-12-16 21:55:39,252 - INFO - 开始读取数据文件。
2024-12-16 21:55:41,295 - INFO - 数据读取完成，共有 1999988 行，14 列。
2024-12-16 21:55:52,376 - INFO - 特征构建完成。
2024-12-16 21:55:52,573 - INFO - 使用MinMaxScaler归一化。
2024-12-16 21:55:52,802 - INFO - PCA降维
2024-12-16 21:55:52,947 - INFO - 尝试使用高斯混合模型(GaussianMixture)聚类。
2024-12-16 21:55:52,947 - INFO - 抽样数据用于计算轮廓系数。
2024-12-16 21:55:52,974 - INFO - 开始使用GaussianMixture进行聚类，并在抽样数据上评估轮廓系数。
2024-12-16 21:55:57,697 - INFO - 基于抽样数据的轮廓系数选择的最佳 n_components=6, 得分=0.8043
2024-12-16 21:55:57,697 - INFO - 最终选择 n_components=6 进行全量聚类。
2024-12-16 21:58:43,296 - INFO - 聚类标签已加入特征数据框。
2024-12-16 21:58:43,297 - INFO - 显示部分聚类标签数据。
2024-12-16 21:58:43,306 - INFO - GMM均值（逆标准化后）：
2024-12-16 21:58:43,312 - INFO - 
           caller_count  callee_count  ...  optr_2_ratio  optr_3_ratio
Cluster 0 -6.783636e-15  1.617823e+00  ... -1.110223e-15 -8.673617e-17
Cluster 1  1.537475e+00 -8.312306e-13  ...  1.000000e+00  6.834810e-16
Cluster 2  2.058395e+00 -6.605259e-13  ...  4.092782e-01  2.338333e-01
Cluster 3  1.360101e+00 -3.398505e-13  ...  5.856426e-15  2.844947e-16
Cluster 4  6.168855e+00 -8.736340e-13  ...  5.344438e-01  7.787607e-02
Cluster 5  1.036615e+01 -1.061799e-12  ...  5.440328e-01  1.273089e-01

[6 rows x 17 columns]
2024-12-16 21:58:43,312 - INFO - 可视化GMM聚类结果（前两维）。
2024-12-16 21:59:16,721 - INFO - 聚类结果散点图已保存为 gmm_pca_scatter.png。
2024-12-16 21:59:33,195 - INFO - 聚类分析完成。
